<!DOCTYPE html>
<html lang="ru">
<head>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ГИБДД Республики Провинция - Официальный сайт</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #1e3a8a;
            --primary-dark: #152c6b;
            --secondary: #dc2626;
            --accent: #fbbf24;
            --light: #f8fafc;
            --dark: #0f172a;
            --gray: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --bg-color: #f1f5f9;
            --card-bg: white;
            --text-color: #0f172a;
            --border-color: #e2e8f0;
            --sidebar-width: 320px;
        }

        .dark-theme {
            --primary: #3b82f6;
            --primary-dark: #1e40af;
            --secondary: #ef4444;
            --accent: #f59e0b;
            --light: #1e293b;
            --dark: #f1f5f9;
            --gray: #94a3b8;
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-color: #f1f5f9;
            --border-color: #334155;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            transition: all 0.3s ease;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 1rem 0;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-icon {
            font-size: 2.5rem;
            background: rgba(255, 255, 255, 0.1);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .logo-text h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            font-weight: 700;
        }
        
        .logo-text p {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .header-controls {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .theme-toggle {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            width: 44px;
            height: 44px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
        }
        
        .theme-toggle:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: rotate(15deg);
        }
        
        .user-profile {
            display: flex;
            align-items: center;
            gap: 12px;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 20px;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .user-profile:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .user-avatar {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--accent), #d97706);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--dark);
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .user-info {
            display: flex;
            flex-direction: column;
        }
        
        .user-name {
            font-weight: 600;
            font-size: 1rem;
        }
        
        .user-rank {
            font-size: 0.85rem;
            opacity: 0.9;
        }
        
        .admin-badge {
            background: var(--secondary);
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 5px;
            font-weight: 600;
        }
        
        .super-admin-badge {
            background: linear-gradient(135deg, gold, #eab308);
            color: var(--dark);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75rem;
            margin-left: 5px;
            font-weight: 600;
        }
        
        /* Navigation */
        nav {
            background-color: var(--card-bg);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            border-bottom: 1px solid var(--border-color);
        }
        
        .nav-tabs {
            display: flex;
            list-style: none;
            overflow-x: auto;
            white-space: nowrap;
        }
        
        .nav-tabs li {
            flex-shrink: 0;
        }
        
        .nav-tabs a {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 16px 20px;
            text-decoration: none;
            color: var(--gray);
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }
        
        .nav-tabs a:hover, .nav-tabs a.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
            background: var(--light);
        }
        
        /* Main Content */
        main {
            padding: 30px 0;
        }
        
        .dashboard {
            display: grid;
            grid-template-columns: 1fr var(--sidebar-width);
            gap: 30px;
        }
        
        .content-section {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 28px;
            margin-bottom: 28px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .content-section:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .section-title {
            display: flex;
            align-items: center;
            margin-bottom: 22px;
            padding-bottom: 18px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .section-title h2 {
            font-size: 1.6rem;
            color: var(--primary);
            font-weight: 700;
        }
        
        .section-title i {
            margin-right: 12px;
            color: var(--secondary);
            font-size: 1.4rem;
        }
        
        /* Map Section */
        .map-container {
            text-align: center;
            margin-top: 20px;
        }
        
        .map-image {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            margin-bottom: 20px;
        }
        
        .map-description {
            background: var(--light);
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid var(--primary);
            margin-top: 20px;
            text-align: left;
        }
        
        .map-description h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 1.3rem;
        }
        
        .map-description p {
            color: var(--gray);
            line-height: 1.6;
        }
        
        /* Binds Section */
        .binds-categories {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .bind-category {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .bind-category:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .bind-category h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .bind-item {
            margin-bottom: 14px;
            padding-bottom: 14px;
            border-bottom: 1px dashed var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
        }
        
        .bind-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .bind-content {
            flex: 1;
        }
        
        .bind-key {
            display: inline-block;
            background: var(--dark);
            color: white;
            padding: 4px 10px;
            border-radius: 6px;
            font-family: monospace;
            margin-right: 10px;
            margin-bottom: 6px;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .bind-description {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 6px;
            line-height: 1.5;
        }
        
        .btn-copy {
            background: var(--primary);
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.3s;
            margin-left: 12px;
            flex-shrink: 0;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .btn-copy:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }
        
        /* Commands Section */
        .commands-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 18px;
            margin-top: 24px;
        }
        
        .command-card {
            background: var(--light);
            border-radius: 10px;
            padding: 18px;
            border: 1px solid var(--border-color);
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .command-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
            border-color: var(--primary);
        }
        
        .command-card h3 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .command-syntax {
            background: var(--dark);
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            margin: 12px 0;
            font-size: 0.95rem;
            overflow-x: auto;
            border-left: 4px solid var(--accent);
        }
        
        .command-desc {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 10px;
            line-height: 1.5;
        }
        
        .command-rank {
            display: inline-block;
            background: var(--secondary);
            color: white;
            padding: 3px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 8px;
            font-weight: 600;
        }
        
        /* Documents Section */
        .documents-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .document-card {
            background: var(--card-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            transition: all 0.3s;
            border: 1px solid var(--border-color);
        }
        
        .document-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 20px rgba(0, 0, 0, 0.15);
        }
        
        .document-icon {
            height: 90px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2.2rem;
        }
        
        .document-content {
            padding: 22px;
        }
        
        .document-content h3 {
            margin-bottom: 12px;
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .document-content p {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 18px;
            line-height: 1.5;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            background: var(--primary);
            color: white;
            padding: 10px 18px;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
            font-size: 0.95rem;
        }
        
        .btn:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.15);
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .btn-danger:hover {
            background: #b91c1c;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-success:hover {
            background: #059669;
        }
        
        .btn-warning {
            background: var(--warning);
            color: var(--dark);
        }
        
        .btn-warning:hover {
            background: #d97706;
        }
        
        /* Sidebar */
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 28px;
        }
        
        .stats-card {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 24px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .stats-card:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .stats-card h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid var(--border-color);
        }
        
        .stat-item:last-child {
            border-bottom: none;
        }
        
        .stat-value {
            font-weight: 700;
            color: var(--primary);
            font-size: 1.1rem;
        }
        
        .quick-links {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 24px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .quick-links:hover {
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.12);
        }
        
        .quick-links h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .links-list {
            list-style: none;
        }
        
        .links-list li {
            margin-bottom: 12px;
        }
        
        .links-list a {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            text-decoration: none;
            color: var(--gray);
            border-radius: 8px;
            transition: all 0.3s;
        }
        
        .links-list a:hover {
            background: var(--light);
            color: var(--primary);
            transform: translateX(5px);
        }
        
        .links-list i {
            color: var(--primary);
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }
        
        /* Footer */
        footer {
            background: var(--dark);
            color: white;
            padding: 40px 0 20px;
            margin-top: 60px;
        }
        
        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 35px;
        }
        
        .footer-section h3 {
            margin-bottom: 18px;
            font-size: 1.3rem;
            font-weight: 600;
        }
        
        .footer-section p {
            color: #cbd5e1;
            margin-bottom: 18px;
            line-height: 1.6;
        }
        
        .footer-links {
            list-style: none;
        }
        
        .footer-links li {
            margin-bottom: 10px;
        }
        
        .footer-links a {
            color: #cbd5e1;
            text-decoration: none;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .footer-links a:hover {
            color: white;
            transform: translateX(5px);
        }
        
        .copyright {
            text-align: center;
            padding-top: 25px;
            margin-top: 25px;
            border-top: 1px solid #334155;
            color: #94a3b8;
            font-size: 0.9rem;
        }
        
        .copyright a {
            color: var(--accent);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
        }
        
        .copyright a:hover {
            color: white;
            text-decoration: underline;
        }
        
        /* Auth Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.6);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            background: var(--card-bg);
            border-radius: 12px;
            width: 100%;
            max-width: 500px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            transform: scale(0.9);
            animation: modalAppear 0.3s forwards;
        }
        
        @keyframes modalAppear {
            to {
                transform: scale(1);
            }
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            padding: 24px;
            text-align: center;
        }
        
        .modal-header h2 {
            font-size: 1.8rem;
            font-weight: 700;
        }
        
        .modal-body {
            padding: 32px;
        }
        
        .auth-tabs {
            display: flex;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .auth-tab {
            flex: 1;
            text-align: center;
            padding: 12px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .auth-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .auth-form {
            display: none;
        }
        
        .auth-form.active {
            display: block;
        }
        
        /* Admin Panel */
        .admin-panel {
            background: var(--card-bg);
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            padding: 28px;
            margin-bottom: 28px;
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
        }
        
        .admin-controls {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .admin-card {
            background: var(--light);
            border-radius: 10px;
            padding: 22px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .admin-card h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 18px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .table th, .table td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }
        
        .table th {
            background: var(--light);
            color: var(--primary);
            font-weight: 600;
        }
        
        .table tr:hover {
            background: var(--light);
        }
        
        /* Statistics Section */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .stat-card {
            background: var(--card-bg);
            border-radius: 10px;
            padding: 24px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            text-align: center;
            border-top: 5px solid var(--primary);
            border: 1px solid var(--border-color);
            transition: all 0.3s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.12);
        }
        
        .stat-card h3 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 1.2rem;
            font-weight: 600;
        }
        
        .stat-card .value {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--text-color);
            margin: 10px 0;
        }
        
        .stat-card .label {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }
        
        .stat-controls {
            display: flex;
            gap: 12px;
            margin-top: 18px;
            justify-content: center;
        }
        
        .stat-controls button {
            padding: 8px 16px;
            font-size: 0.9rem;
            font-weight: 600;
        }
        
        /* Leaderboard Section */
        .leaderboard-tabs {
            display: flex;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .leaderboard-tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .leaderboard-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        /* Profile Section */
        .profile-info {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-top: 24px;
        }
        
        .profile-card {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
        }
        
        .profile-card h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .profile-field {
            margin-bottom: 14px;
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .profile-field:last-child {
            border-bottom: none;
        }
        
        .profile-field .label {
            font-weight: 600;
            color: var(--gray);
        }
        
        .profile-field .value {
            color: var(--text-color);
            font-weight: 500;
        }
        
        /* Form Elements */
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        .form-control {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 1rem;
            background: var(--card-bg);
            color: var(--text-color);
            transition: all 0.3s;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(30, 58, 138, 0.1);
        }
        
        /* Admin Tabs */
        .admin-tabs {
            display: flex;
            margin-bottom: 24px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .admin-tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .admin-tab.active {
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
            font-weight: 600;
        }
        
        .admin-tab-content {
            display: none;
        }
        
        .admin-tab-content.active {
            display: block;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                order: -1;
            }
            
            .profile-info {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 18px;
                text-align: center;
            }
            
            .header-controls {
                justify-content: center;
            }
            
            .admin-controls {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: 1fr;
            }
            
            .binds-categories {
                grid-template-columns: 1fr;
            }
            
            .commands-grid {
                grid-template-columns: 1fr;
            }
            
            .documents-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 0 15px;
            }
        }

        /* Стили для новых разделов */
        
        /* Стили для раздела оружия */
        .weapon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .weapon-card {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .weapon-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .weapon-card h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .weapon-info {
            margin-bottom: 14px;
            padding-bottom: 14px;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .weapon-info:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .weapon-info .label {
            font-weight: 600;
            color: var(--gray);
            margin-bottom: 5px;
        }
        
        .weapon-info .value {
            color: var(--text-color);
            line-height: 1.5;
        }
        
        /* Стили для раздела радиообмена */
        .radio-category {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            margin-bottom: 24px;
            transition: all 0.3s;
        }
        
        .radio-category:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .radio-category h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .radio-item {
            margin-bottom: 14px;
            padding-bottom: 14px;
            border-bottom: 1px dashed var(--border-color);
        }
        
        .radio-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .radio-syntax {
            background: var(--dark);
            color: white;
            padding: 10px;
            border-radius: 6px;
            font-family: monospace;
            margin: 8px 0;
            font-size: 0.95rem;
            overflow-x: auto;
            border-left: 4px solid var(--accent);
        }
        
        .radio-desc {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 6px;
            line-height: 1.5;
        }
        
        /* Стили для раздела юрисдикций */
        .jurisdiction-map {
            text-align: center;
            margin: 20px 0;
        }
        
        .jurisdiction-image {
            max-width: 100%;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            margin-bottom: 20px;
        }
        
        .jurisdiction-info {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .jurisdiction-card {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-top: 5px solid;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .jurisdiction-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        }
        
        .jurisdiction-card h3 {
            margin-bottom: 18px;
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .jurisdiction-card.mirny {
            border-top-color: #3b82f6; /* Синий для Мирного */
        }
        
        .jurisdiction-card.mirny h3 {
            color: #3b82f6;
        }
        
        .jurisdiction-card.nevsky {
            border-top-color: #ef4444; /* Красный для Невского */
        }
        
        .jurisdiction-card.nevsky h3 {
            color: #ef4444;
        }
        
        .jurisdiction-card.privolzhsk {
            border-top-color: #10b981; /* Зеленый для Приволжска */
        }
        
        .jurisdiction-card.privolzhsk h3 {
            color: #10b981;
        }

        /* Новые стили для настроек */
        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }
        
        .setting-card {
            background: var(--light);
            border-radius: 10px;
            padding: 24px;
            border-left: 5px solid var(--primary);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.05);
            transition: all 0.3s;
        }
        
        .setting-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.08);
        }
        
        .setting-card h3 {
            margin-bottom: 18px;
            color: var(--primary);
            font-size: 1.3rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .setting-option {
            margin-bottom: 16px;
            padding-bottom: 16px;
            border-bottom: 1px solid var(--border-color);
        }
        
        .setting-option:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }
        
        .setting-label {
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--text-color);
        }
        
        .setting-description {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 12px;
        }
        
        /* Стили для модальных окон */
        .modal-small {
            max-width: 400px;
        }
        
        .modal-medium {
            max-width: 500px;
        }
        
        .modal-large {
            max-width: 600px;
        }
        
        .danger-zone {
            border: 2px solid var(--danger);
            border-radius: 8px;
            padding: 20px;
            margin-top: 20px;
            background: rgba(239, 68, 68, 0.05);
        }
        
        .danger-zone h4 {
            color: var(--danger);
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        /* Стили для выбора званий и должностей */
        .rank-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
            margin-top: 15px;
        }
        
        .rank-option {
            padding: 12px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
        }
        
        .rank-option:hover {
            border-color: var(--primary);
            background: rgba(30, 58, 138, 0.05);
        }
        
        .rank-option.selected {
            border-color: var(--primary);
            background: var(--primary);
            color: white;
        }
        
        .rank-option.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: var(--border-color);
        }

        /* Switch toggle */
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }
        
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: var(--border-color);
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(26px);
        }
        /* Исправления для темной темы */
.dark-theme .btn-outline {
  background: transparent;
  border: 2px solid var(--primary);
  color: var(--primary);
}

.dark-theme .btn-outline:hover {
  background: var(--primary);
  color: white;
}

.dark-theme footer {
  background: #020617;
}

.dark-theme .bind-category,
.dark-theme .command-card,
.dark-theme .document-card,
.dark-theme .weapon-card,
.dark-theme .radio-category,
.dark-theme .jurisdiction-card,
.dark-theme .setting-card,
.dark-theme .admin-card,
.dark-theme .profile-card,
.dark-theme .stats-card,
.dark-theme .quick-links {
  background: var(--card-bg);
  color: var(--text-color);
}
    </style>
</head>
<body>
    <!-- Auth Modal -->
    <div id="authModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2><i class="fas fa-user-shield"></i> Авторизация</h2>
            </div>
            <div class="modal-body">
                <div class="auth-tabs">
                    <div class="auth-tab active" onclick="showAuthForm('login')"><i class="fas fa-sign-in-alt"></i> Вход</div>
                    <div class="auth-tab" onclick="showAuthForm('register')"><i class="fas fa-user-plus"></i> Регистрация</div>
                </div>
                
                <form id="loginForm" class="auth-form active">
                    <div class="form-group">
                        <label for="loginUsername"><i class="fas fa-user"></i> Логин или Email</label>
                        <input type="text" id="loginUsername" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword"><i class="fas fa-lock"></i> Пароль</label>
                        <input type="password" id="loginPassword" class="form-control" required>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;"><i class="fas fa-sign-in-alt"></i> Войти</button>
                </form>
                
                <form id="registerForm" class="auth-form">
                    <div class="form-group">
                        <label for="registerNickname"><i class="fas fa-id-card"></i> Игровой ник</label>
                        <input type="text" id="registerNickname" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerUsername"><i class="fas fa-user"></i> Логин</label>
                        <input type="text" id="registerUsername" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerEmail"><i class="fas fa-envelope"></i> Email</label>
                        <input type="email" id="registerEmail" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerPassword"><i class="fas fa-lock"></i> Пароль</label>
                        <input type="password" id="registerPassword" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="registerConfirmPassword"><i class="fas fa-lock"></i> Подтвердите пароль</label>
                        <input type="password" id="registerConfirmPassword" class="form-control" required>
                    </div>
                    <button type="submit" class="btn" style="width: 100%;"><i class="fas fa-user-plus"></i> Зарегистрироваться</button>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно смены пароля -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2><i class="fas fa-lock"></i> Смена пароля</h2>
            </div>
            <div class="modal-body">
                <form id="changePasswordForm">
                    <div class="form-group">
                        <label for="currentPassword"><i class="fas fa-lock"></i> Текущий пароль</label>
                        <input type="password" id="currentPassword" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="newPassword"><i class="fas fa-key"></i> Новый пароль</label>
                        <input type="password" id="newPassword" class="form-control" required>
                    </div>
                    <div class="form-group">
                        <label for="confirmNewPassword"><i class="fas fa-key"></i> Подтвердите новый пароль</label>
                        <input type="password" id="confirmNewPassword" class="form-control" required>
                    </div>
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-success" style="flex: 1;"><i class="fas fa-save"></i> Сохранить</button>
                        <button type="button" class="btn btn-outline" style="flex: 1;" onclick="hideModal('changePasswordModal')"><i class="fas fa-times"></i> Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно смены никнейма -->
    <div id="changeNicknameModal" class="modal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2><i class="fas fa-user-edit"></i> Смена никнейма</h2>
            </div>
            <div class="modal-body">
                <form id="changeNicknameForm">
                    <div class="form-group">
                        <label for="newNickname"><i class="fas fa-signature"></i> Новый никнейм</label>
                        <input type="text" id="newNickname" class="form-control" required>
                    </div>
                    <div id="nicknameTarget" style="display: none;">
                        <div class="form-group">
                            <label for="targetUser">Для пользователя</label>
                            <select id="targetUser" class="form-control">
                                <!-- Заполнится JavaScript -->
                            </select>
                        </div>
                    </div>
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-success" style="flex: 1;"><i class="fas fa-save"></i> Сохранить</button>
                        <button type="button" class="btn btn-outline" style="flex: 1;" onclick="hideModal('changeNicknameModal')"><i class="fas fa-times"></i> Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно выбора звания и должности -->
    <div id="rankPositionModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-user-tie"></i> Выбор звания и должности</h2>
            </div>
            <div class="modal-body">
                <form id="rankPositionForm">
                    <div id="rankPositionTarget" style="display: none;">
                        <div class="form-group">
                            <label for="targetUserRank">Для пользователя</label>
                            <select id="targetUserRank" class="form-control">
                                <!-- Заполнится JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="selectedRank"><i class="fas fa-star"></i> Звание</label>
                        <div class="rank-grid">
                            <div class="rank-option" data-rank="Рядовой" onclick="selectRank('Рядовой')">Рядовой</div>
                            <div class="rank-option" data-rank="Сержант" onclick="selectRank('Сержант')">Сержант</div>
                            <div class="rank-option" data-rank="Старшина" onclick="selectRank('Старшина')">Старшина</div>
                            <div class="rank-option" data-rank="Прапорщик" onclick="selectRank('Прапорщик')">Прапорщик</div>
                            <div class="rank-option" data-rank="Лейтенант" onclick="selectRank('Лейтенант')">Лейтенант</div>
                            <div class="rank-option" data-rank="Старший лейтенант" onclick="selectRank('Старший лейтенант')">Ст. лейтенант</div>
                            <div class="rank-option" data-rank="Капитан" onclick="selectRank('Капитан')">Капитан</div>
                            <div class="rank-option" data-rank="Майор" onclick="selectRank('Майор')">Майор</div>
                        </div>
                        <input type="hidden" id="selectedRank" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="positionInput"><i class="fas fa-briefcase"></i> Должность</label>
                        <input type="text" id="positionInput" class="form-control" placeholder="Например: Инспектор ДПС" required>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-success" style="flex: 1;"><i class="fas fa-save"></i> Сохранить</button>
                        <button type="button" class="btn btn-outline" style="flex: 1;" onclick="hideModal('rankPositionModal')"><i class="fas fa-times"></i> Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Модальное окно редактирования статистики -->
    <div id="editStatsModal" class="modal">
        <div class="modal-content modal-medium">
            <div class="modal-header">
                <h2><i class="fas fa-chart-bar"></i> Редактирование статистики</h2>
            </div>
            <div class="modal-body">
                <form id="editStatsForm">
                    <div class="form-group">
                        <label for="statsUser">Пользователь</label>
                        <select id="statsUser" class="form-control" required>
                            <!-- Заполнится JavaScript -->
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="editFines">Выдано штрафов</label>
                        <input type="number" id="editFines" class="form-control" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editArrests">Задержано преступников</label>
                        <input type="number" id="editArrests" class="form-control" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editLicenses">Изъято прав</label>
                        <input type="number" id="editLicenses" class="form-control" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editSearches">Проведено досмотров</label>
                        <input type="number" id="editSearches" class="form-control" min="0" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="editRating">Общий рейтинг</label>
                        <input type="number" id="editRating" class="form-control" required>
                    </div>
                    
                    <div class="form-group" style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-success" style="flex: 1;"><i class="fas fa-save"></i> Сохранить</button>
                        <button type="button" class="btn btn-outline" style="flex: 1;" onclick="hideModal('editStatsModal')"><i class="fas fa-times"></i> Отмена</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <div class="logo-icon">🚓</div>
                    <div class="logo-text">
                        <h1>ГИБДД Республики Провинция</h1>
                        <p>Официальный сайт дорожно-патрульной службы</p>
                    </div>
                </div>
                <div class="header-controls">
                    <button class="theme-toggle" id="themeToggle" title="Переключить тему">🌙</button>
                    <div class="user-profile" id="userProfile" onclick="toggleProfileForm()">
                        <div class="user-avatar">?</div>
                        <div class="user-info">
                            <div class="user-name">Гость</div>
                            <div class="user-rank">Не авторизован</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>
    
    <!-- Navigation -->
    <nav>
        <div class="container">
            <ul class="nav-tabs">
                <li><a href="#" class="active" onclick="showSection('dashboard')"><i class="fas fa-tachometer-alt"></i> Главная</a></li>
                <li><a href="#" onclick="showSection('binds')"><i class="fas fa-keyboard"></i> Бинды</a></li>
                <li><a href="#" onclick="showSection('commands')"><i class="fas fa-terminal"></i> Команды</a></li>
                <li><a href="#" onclick="showSection('documents')"><i class="fas fa-file-alt"></i> Документы</a></li>
                <li><a href="#" onclick="showSection('weapon')"><i class="fas fa-shield-alt"></i> Табельное оружие</a></li>
                <li><a href="#" onclick="showSection('radio')"><i class="fas fa-walkie-talkie"></i> Регламент радиообмена</a></li>
                <li><a href="#" onclick="showSection('jurisdiction')"><i class="fas fa-map-marked-alt"></i> Юрисдикции МВД</a></li>
                <li><a href="#" onclick="showSection('map')"><i class="fas fa-map"></i> Карта постов</a></li>
                <li><a href="#" onclick="showSection('statistics')"><i class="fas fa-chart-bar"></i> Статистика</a></li>
                <li><a href="#" onclick="showSection('leaderboard')"><i class="fas fa-trophy"></i> Таблица лидеров</a></li>
                <li><a href="#" onclick="showSection('profile')" id="profileTab"><i class="fas fa-user"></i> Профиль</a></li>
                <li><a href="#" onclick="showSection('settings')" id="settingsTab"><i class="fas fa-cog"></i> Настройки</a></li>
                <li><a href="#" onclick="showSection('admin')" id="adminTab" style="display:none;"><i class="fas fa-cogs"></i> Админ-панель</a></li>
            </ul>
        </div>
    </nav>
    
    <!-- Main Content -->
    <main class="container">
        <div class="dashboard">
            <div class="main-content">
                <!-- Dashboard Section -->
                <section id="dashboard-section" class="content-section">
                    <div class="section-title">
                        <i class="fas fa-tachometer-alt"></i>
                        <h2>Панель управления</h2>
                    </div>
                    <p>Добро пожаловать на официальный сайт ГИБДД Республики Провинция. Здесь вы найдете всю необходимую информацию для эффективной службы в дорожно-патрульной службе.</p>
                    
                    <div class="binds-categories" style="margin-top: 30px;">
                        <div class="bind-category">
                            <h3><i class="fas fa-id-card"></i> Основные бинды</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">1</span>
                                    <span>Представление инспектора</span>
                                </div>
                                <button class="btn-copy" onclick="copyBind('1')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">3</span>
                                    <span>Требование документов</span>
                                </div>
                                <button class="btn-copy" onclick="copyBind('3')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">HOME</span>
                                    <span>Приветствие с коллегами</span>
                                </div>
                                <button class="btn-copy" onclick="copyBind('HOME')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <div class="bind-category">
                            <h3><i class="fas fa-traffic-light"></i> Остановка ТС</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">9</span>
                                    <span>Требование об остановке ТС</span>
                                </div>
                                <button class="btn-copy" onclick="copyBind('9')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">0</span>
                                    <span>Повторное требование</span>
                                </div>
                                <button class="btn-copy" onclick="copyBind('0')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Binds Section -->
                <section id="binds-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-keyboard"></i>
                        <h2>Бинды для игры</h2>
                    </div>
                    <p>На этой странице представлены все необходимые бинды для эффективного выполнения служебных обязанностей.</p>
                    
                    <div class="binds-categories">
                        <!-- Представление -->
                        <div class="bind-category">
                            <h3><i class="fas fa-id-card"></i> Представление</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">1</span>
                                    <span>Представление инспектора полиции</span>
                                    <div class="bind-description">bind 1 say Здравия желаю, [Звание] полиции [Фамилия], [должность] ДПС ОГИБДД по городу Приволжск.</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 1 say Здравия желаю, [Звание] полиции [Фамилия], [должность] ДПС ОГИБДД по городу Приволжск.')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">1</span>
                                    <span>Представление инспектора внутренней службы (ОКН)</span>
                                    <div class="bind-description">bind 1 say Здравия желаю, [Звание] внутренней службы [Фамилия], [должность] ДПС ОГИБДД по городу Приволжск.</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 1 say Здравия желаю, [Звание] внутренней службы [Фамилия], [должность] ДПС ОГИБДД по городу Приволжск.')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">3</span>
                                    <span>Требование о предоставлении документов</span>
                                    <div class="bind-description">bind 3 say Гражданин, предоставьте Ваше водительское удостоверение и регистрационные документы.</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 3 say Гражданин, предоставьте Ваше водительское удостоверение и регистрационные документы.')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">HOME</span>
                                    <span>Приветствие с коллегами</span>
                                    <div class="bind-description">bind home say Здравия желаю!<br>bind home animarmy 3</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind home say Здравия желаю!\nbind home animarmy 3')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Оформление протокола -->
                        <div class="bind-category">
                            <h3><i class="fas fa-file-contract"></i> Оформление протокола</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">F2</span>
                                    <span>Начало оформления протоколов</span>
                                    <div class="bind-description">bind F2 do На плече сотрудника висит кожаная папка с планшеткой, бланками и ручкой.<br>bind F2 me вытащил из кожаной папки планшетку с бланками и ручку<br>bind F2 up me начинает составлять административный протокол и его копию</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind F2 do На плече сотрудника висит кожаная папка с планшеткой, бланками и ручкой.\nbind F2 me вытащил из кожаной папки планшетку с бланками и ручку\nbind F2 up me начинает составлять административный протокол и его копию')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">F4</span>
                                    <span>Передача протоколов на подпись</span>
                                    <div class="bind-description">bind F4 me закончив составлять административный протокол и его копию, вытащил протоколы из-под зажима<br>bind F4 me передал протокол, копию и ручку на подпись, после чего внёс нужную информацию в планшет<br>bind F4 say Вот, возьмите распишитесь. Копию оставляете себе, оригинал и ручку возвращаете мне.</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind F4 me закончив составлять административный протокол и его копию, вытащил протоколы из-под зажима\nbind F4 me передал протокол, копию и ручку на подпись, после чего внёс нужную информацию в планшет\nbind F4 say Вот, возьмите распишитесь. Копию оставляете себе, оригинал и ручку возвращаете мне.')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">F7</span>
                                    <span>Окончание оформления протокола</span>
                                    <div class="bind-description">bind F7 me взял подписанный оригинал протокола с ручкой<br>bind F7 up me убрал оригинал протокола с планшеткой и ручкой в кожаную папку</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind F7 me взял подписанный оригинал протокола с ручкой\nbind F7 up me убрал оригинал протокола с планшеткой и ручкой в кожаную папку')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Остановка ТС -->
                        <div class="bind-category">
                            <h3><i class="fas fa-car"></i> Остановка ТС</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">9</span>
                                    <span>Требование об остановке ТС</span>
                                    <div class="bind-description">bind 9 me снял тангенту с крепления и поднёс её ко рту, зажав кнопку «PTT»<br>bind 9 down m Водитель, это полиция, принимаем крайнее правое положение и останавливаемся!<br>bind 9 up me зафиксировал тангенту громкоговорителя на креплении, отпустив кнопку «PTT»</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 9 me снял тангенту с крепления и поднёс её ко рту, зажав кнопку «PTT»\nbind 9 down m Водитель, это полиция, принимаем крайнее правое положение и останавливаемся!\nbind 9 up me зафиксировал тангенту громкоговорителя на креплении, отпустив кнопку «PTT»')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">0</span>
                                    <span>Если гражданин не реагирует</span>
                                    <div class="bind-description">bind 0 me снял тангенту с крепления и поднёс её ко рту, зажав кнопку «PTT»<br>bind 0 down m Водитель, это полиция, останавливаемся, иначе открываю огонь!<br>bind 0 up me зафиксировал тангенту громкоговорителя на креплении, отпустив кнопку «PTT»</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 0 me снял тангенту с крепления и поднёс её ко рту, зажав кнопку «PTT»\nbind 0 down m Водитель, это полиция, останавливаемся, иначе открываю огонь!\nbind 0 up me зафиксировал тангенту громкоговорителя на креплении, отпустив кнопку «PTT»')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">NUM -</span>
                                    <span>Требование об остановке при побеге</span>
                                    <div class="bind-description">bind num_sub s Гражданин, это полиция, немедленно остановитесь! В случае отказа применяю спец.средства, или огнестрельное оружие!</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind num_sub s Гражданин, это полиция, немедленно остановитесь! В случае отказа применяю спец.средства, или огнестрельное оружие!')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Отыгровка с планшетом -->
                        <div class="bind-category">
                            <h3><i class="fas fa-tablet-alt"></i> Отыгровка с планшетом</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">7</span>
                                    <span>Доставание планшета</span>
                                    <div class="bind-description">bind 7 do Электронный планшет лежит в кожаной папке на плече.<br>bind 7 me открыв кожаную папку, достал из неё электронный планшет<br>bind 7 up me включив планшет, открыл базу данных МВД</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 7 do Электронный планшет лежит в кожаной папке на плече.\nbind 7 me открыв кожаную папку, достал из неё электронный планшет\nbind 7 up me включив планшет, открыл базу данных МВД')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">NUM /</span>
                                    <span>Пробитие информации о штрафах</span>
                                    <div class="bind-description">bind num_div me ввёл данные с водительского удостоверения в базу данных МВД через планшет<br>bind num_div do На экране планшета появилась информация.<br>bind num_div chatbox skan</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind num_div me ввёл данные с водительского удостоверения в базу данных МВД через планшет\nbind num_div do На экране планшета появилась информация.\nbind num_div chatbox skan')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">F10</span>
                                    <span>Пробитие информации по номеру</span>
                                    <div class="bind-description">bind F10 me взглянув на номерной знак ТС, вписал их в базу данных МВД через планшет<br>bind F10 do На экране планшета появилась информация.<br>bind f10 chatbox findcar</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind F10 me взглянув на номерной знак ТС, вписал их в базу данных МВД через планшет\nbind F10 do На экране планшета появилась информация.\nbind f10 chatbox findcar')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">NUM *</span>
                                    <span>Оформление электронного штрафа</span>
                                    <div class="bind-description">bind num_mul me выписал электронный штраф водителю через планшет<br>bind num_mul chatbox tsu</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind num_mul me выписал электронный штраф водителю через планшет\nbind num_mul chatbox tsu')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">F9</span>
                                    <span>Лишение водителя</span>
                                    <div class="bind-description">bind F9 me аннулировал водительское удостоверение водителя через планшет<br>bind F9 say Ваше водительское удостоверение аннулировано.<br>bind F9 up say По истечению срока лишения можете пересдать на права в Автошколе.<br>bind F9 chatbox takecarlic</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind F9 me аннулировал водительское удостоверение водителя через планшет\nbind F9 say Ваше водительское удостоверение аннулировано.\nbind F9 up say По истечению срока лишения можете пересдать на права в Автошколе.\nbind F9 chatbox takecarlic')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">NUM +</span>
                                    <span>Завершение работы с планшетом</span>
                                    <div class="bind-description">bind num_add me выключив планшет, убрал его в кожаную папку, после чего закрыл её</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind num_add me выключив планшет, убрал его в кожаную папку, после чего закрыл её')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Отыгровки спецсредств -->
                        <div class="bind-category">
                            <h3><i class="fas fa-shield-alt"></i> Отыгровки спецсредств</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">Ж</span>
                                    <span>Достать жезл</span>
                                    <div class="bind-description">bind ; do Через плечо сотрудника висит закрытая кожаная папка с жезлом внутри.<br>bind ; me открыв кожаную папку, вытащил из неё жезл, после закрыл папку</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind ; do Через плечо сотрудника висит закрытая кожаная папка с жезлом внутри.\nbind ; me открыв кожаную папку, вытащил из неё жезл, после закрыл папку')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">Э</span>
                                    <span>Убрать жезл</span>
                                    <div class="bind-description">bind ' me открыв кожаную папку, убрал в неё жезл, после закрыл папку</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind \' me открыв кожаную папку, убрал в неё жезл, после закрыл папку')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">(Настроить)</span>
                                    <span>Наручники</span>
                                    <div class="bind-description">bind клавиша say Вы задержаны и будете доставлены в отделение. Сопротивляться не советую.<br>bind клавиша chatbox cuff</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind клавиша say Вы задержаны и будете доставлены в отделение. Сопротивляться не советую.\nbind клавиша chatbox cuff')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Досмотр гражданина -->
                        <div class="bind-category">
                            <h3><i class="fas fa-search"></i> Досмотр гражданина</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">(Настроить)</span>
                                    <span>Начало досмотра</span>
                                    <div class="bind-description">bind клавиша do На плече сотрудника висит кожаная папка с перчатками.<br>bind клавиша me открыл папку и достал перчатки, надел их на руки<br>bind клавиша say Есть у Вас что-то запрещенное: оружие, наркотики?<br>bind клавиша up me аккуратно досмотрел задержанного</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind клавиша do На плече сотрудника висит кожаная папка с перчатками.\nbind клавиша me открыл папку и достал перчатки, надел их на руки\nbind клавиша say Есть у Вас что-то запрещенное: оружие, наркотики?\nbind клавиша up me аккуратно досмотрел задержанного')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">(Настроить)</span>
                                    <span>Окончание досмотра</span>
                                    <div class="bind-description">bind клавиша me снял перчатки и положил их в кожаную папку, закрыл кожаную папку</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind клавиша me снял перчатки и положил их в кожаную папку, закрыл кожаную папку')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Посадка в автомобиль/КПЗ -->
                        <div class="bind-category">
                            <h3><i class="fas fa-car-side"></i> Посадка в автомобиль/КПЗ</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">6</span>
                                    <span>Посадка в патрульный автомобиль</span>
                                    <div class="bind-description">bind 6 say Аккуратно, бережём голову при посадке в патрульный автомобиль.<br>bind 6 me отпустил руку задержанного, немного наклонил его перед дверью и усадил в салон автомобиля<br>bind 6 chatbox dearr</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind 6 say Аккуратно, бережём голову при посадке в патрульный автомобиль.\nbind 6 me отпустил руку задержанного, немного наклонил его перед дверью и усадил в салон автомобиля\nbind 6 chatbox dearr')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">Б</span>
                                    <span>Передача задержанного конвоиру</span>
                                    <div class="bind-description">bind , s Конвоир!<br>bind , me передал задержанного конвоиру<br>bind , do Конвоир увёл задержанного в ИВС.<br>bind , chatbox arrest</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind , s Конвоир!\nbind , me передал задержанного конвоиру\nbind , do Конвоир увёл задержанного в ИВС.\nbind , chatbox arrest')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                        
                        <!-- Рация -->
                        <div class="bind-category">
                            <h3><i class="fas fa-walkie-talkie"></i> Рация</h3>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">-</span>
                                    <span>Использование рации</span>
                                    <div class="bind-description">bind - do На теле сотрудника закреплена рация.<br>bind - me снял с себя рацию и зажал кнопку<br>bind - fracvoice 1</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind - do На теле сотрудника закреплена рация.\nbind - me снял с себя рацию и зажал кнопку\nbind - fracvoice 1')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">=</span>
                                    <span>Завершение использования рации</span>
                                    <div class="bind-description">bind = me отжав кнопку, вернул рацию на крепление<br>bind = fracvoice 2</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind = me отжав кнопку, вернул рацию на крепление\nbind = fracvoice 2')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                            <div class="bind-item">
                                <div class="bind-content">
                                    <span class="bind-key">/</span>
                                    <span>Объявление гражданина в розыск</span>
                                    <div class="bind-description">bind / me передал информацию о подозреваемом оперативному дежурному<br>bind / do Оперативный дежурный объявил подозреваемого в розыск.<br>bind / chatbox su</div>
                                </div>
                                <button class="btn-copy" onclick="copyBindText('bind / me передал информацию о подозреваемом оперативному дежурному\nbind / do Оперативный дежурный объявил подозреваемого в розыск.\nbind / chatbox su')"><i class="fas fa-copy"></i> Копировать</button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Commands Section -->
                <section id="commands-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-terminal"></i>
                        <h2>Игровые команды</h2>
                    </div>
                    <p>Список всех доступных команд для сотрудников ГИБДД с указанием необходимого ранга для использования.</p>
                    
                    <div class="commands-grid">
                        <div class="command-card">
                            <h3>/m [Текст]</h3>
                            <div class="command-syntax">/m Водитель, остановитесь!</div>
                            <p class="command-desc">Использование мегафона с указанным текстом.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/animarmy [1-9]</h3>
                            <div class="command-syntax">/animarmy 3</div>
                            <p class="command-desc">Вызов анимации: 1-отжимания, 2-приседания, 3-воинское приветствие и т.д.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/arr [ID]</h3>
                            <div class="command-syntax">/arr 25</div>
                            <p class="command-desc">Конвоирование преступника, когда он закован в наручники.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/dearr [ID]</h3>
                            <div class="command-syntax">/dearr 25</div>
                            <p class="command-desc">Отпустить преступника с конвоирования.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/wanted</h3>
                            <div class="command-syntax">/wanted</div>
                            <p class="command-desc">Выводит список всех игроков онлайн, которые находятся в розыске.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/crimrec</h3>
                            <div class="command-syntax">/crimrec 25</div>
                            <p class="command-desc">Показать совершенные преступления игрока.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/fines</h3>
                            <div class="command-syntax">/fines</div>
                            <p class="command-desc">Выводит список всех игроков онлайн с неоплаченными штрафами.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/findcar [номер]</h3>
                            <div class="command-syntax">/findcar а123ус78</div>
                            <p class="command-desc">Находит владельца машины по номеру.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/takecarlic [ID] [время]</h3>
                            <div class="command-syntax">/takecarlic 25 3</div>
                            <p class="command-desc">Отобрать права у игрока на категории B, C, D.</p>
                            <div class="command-rank">Ранг: 3+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/su [ID] [уровень] [причина]</h3>
                            <div class="command-syntax">/su 25 3 Нарушение ПДД</div>
                            <p class="command-desc">Подать игрока в розыск.</p>
                            <div class="command-rank">Ранг: 2+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/givecarlic [ID]</h3>
                            <div class="command-syntax">/givecarlic 25</div>
                            <p class="command-desc">Вернуть возможность сдать на права.</p>
                            <div class="command-rank">Ранг: 9+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/tsu [ID] [сумма] [причина]</h3>
                            <div class="command-syntax">/tsu 25 5000 Превышение скорости</div>
                            <p class="command-desc">Зафиксировать нарушение ПДД.</p>
                            <div class="command-rank">Ранг: 3+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/skan [ID]</h3>
                            <div class="command-syntax">/skan 25</div>
                            <p class="command-desc">Определить кол-во нарушений ПДД.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/cuff [ID]</h3>
                            <div class="command-syntax">/cuff 25</div>
                            <p class="command-desc">Надевает на преступника наручники.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/putpl</h3>
                            <div class="command-syntax">/putpl</div>
                            <p class="command-desc">Посадить преступника в машину.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/uncuff [ID]</h3>
                            <div class="command-syntax">/uncuff 25</div>
                            <p class="command-desc">Снимает наручники с преступника.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/arrest [ID]</h3>
                            <div class="command-syntax">/arrest 25</div>
                            <p class="command-desc">Посадить игрока в КПЗ.</p>
                            <div class="command-rank">Ранг: 1+</div>
                        </div>
                        
                        <div class="command-card">
                            <h3>/giverank [ID] [ранг]</h3>
                            <div class="command-syntax">/giverank 25 5</div>
                            <p class="command-desc">Изменить ранг игрока.</p>
                            <div class="command-rank">Ранг: 9+</div>
                        </div>
                    </div>
                </section>
                
                <!-- Documents Section -->
                <section id="documents-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-file-alt"></i>
                        <h2>Нормативные документы</h2>
                    </div>
                    <p>Официальные документы, регулирующие деятельность ГИБДД и других правоохранительных органов Республики Провинция.</p>
                    
                    <div class="documents-grid">
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-car"></i></div>
                            <div class="document-content">
                                <h3>Административный регламент ГИБДД</h3>
                                <p>Регламент, определяющий порядок выполнения административных процедур сотрудниками ГИБДД.</p>
                                <a href="https://forum.gtaprovince.ru/topic/724436-administrativnyy-reglament-gibdd-ot-01072020-n-1/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                        
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-gavel"></i></div>
                            <div class="document-content">
                                <h3>Федеральный закон о полиции</h3>
                                <p>Основной закон, регулирующий деятельность полиции в Республике Провинция.</p>
                                <a href="https://forum.gtaprovince.ru/topic/724457-federalnyy-zakon-o-policii-ot-12112024-n-3-fz/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                        
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-clipboard-list"></i></div>
                            <div class="document-content">
                                <h3>Приказы МВД</h3>
                                <p>Сборник приказов Министерства внутренних дел по Республике Провинция.</p>
                                <a href="https://forum.gtaprovince.ru/topic/724445-prikazy-ministerstva-vnutrennih-del-po-respublike-provinciya/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                        
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-lock"></i></div>
                            <div class="document-content">
                                <h3>Уголовный кодекс РП</h3>
                                <p>Уголовный кодекс Республики Провинция с последними изменениями.</p>
                                <a href="https://forum.gtaprovince.ru/topic/639258-ugolovnyy-kodeks-respubliki/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                        
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-file-contract"></i></div>
                            <div class="document-content">
                                <h3>Кодекс об административных правонарушениях</h3>
                                <p>Кодекс, регулирующий административные правонарушения в Республике Провинция.</p>
                                <a href="https://forum.gtaprovince.ru/topic/639260-kodeks-ob-administrativnyh-pravonarusheniyah-respubliki/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                        
                        <div class="document-card">
                            <div class="document-icon"><i class="fas fa-scroll"></i></div>
                            <div class="document-content">
                                <h3>Конституция Республики Провинция</h3>
                                <p>Основной закон государства, принятый голосованием 15.07.2024 года.</p>
                                <a href="https://forum.gtaprovince.ru/topic/828538-konstituciya-respubliki-provinciya-prinyata-golosovaniem-15072024-goda/" target="_blank" class="btn"><i class="fas fa-external-link-alt"></i> Открыть</a>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Weapon Section -->
                <section id="weapon-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-shield-alt"></i>
                        <h2>Справка по табельному оружию и снаряжению</h2>
                    </div>
                    <p>Информация о табельном оружии, спецсредствах и снаряжении, доступном сотрудникам ДПС ОГИБДД.</p>
                    
                    <div class="weapon-grid">
                        <div class="weapon-card">
                            <h3><i class="fas fa-gavel"></i> Дубинка резиновая ПУС-2 «Аргумент-М»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступна всем сотрудникам ДПС ОГИБДД</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для нейтрализации подозреваемого с целью последующего ареста</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-traffic-light"></i> Жезл регулировщика</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступен всем сотрудникам ДПС ОГИБДД</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для остановки транспортного средства и регулирования дорожного движения</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-vest"></i> Бронежилет «КОРА-1М»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступен всем сотрудникам ДПС ОГИБДД</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Является средством индивидуальной защиты сотрудников ДПС ОГИБДД от огнестрельного оружия</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-bolt"></i> Электрошоковое устройство «Taser»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступен всем сотрудникам ДПС ОГИБДД</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для остановки и нейтрализации подозреваемого на более длительных дистанциях с целью последующего ареста</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-gun"></i> Пистолет «MP-443 «Грач»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступен сотрудникам ДПС ОГИБДД звания "Старшина полиции" и выше. Запрещен для использования курсантам УК и стажёрам ОБ.</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для нейтрализации преступника, в случае угрозы жизни гражданскому населению или жизни сотрудника, непосредственно. Также используется для стрельбы из окна по колёсам.</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-gun"></i> Гладкоствольное ружьё «МР-133»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступно всем сотрудникам со звания "Лейтенант полиции"</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для нейтрализации преступника, в случае угрозы жизни сотрудника или гражданскому населению. Также используется с целью устрашения и морального подавления противника. Крайне неэффективно на дальних дистанциях.</div>
                            </div>
                        </div>
                        
                        <div class="weapon-card">
                            <h3><i class="fas fa-gun"></i> Автомат «АК-74M»</h3>
                            <div class="weapon-info">
                                <div class="label">Доступность:</div>
                                <div class="value">Доступен всем сотрудникам ОСР и инструкторам</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Назначение:</div>
                                <div class="value">Используется для выезда за особо-опасными преступниками и нарушителями, а также с целью нейтрализации преступника на дальней дистанции в случае угрозы жизни гражданскому населению или сотрудника, непосредственно.</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Radio Section -->
                <section id="radio-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-walkie-talkie"></i>
                        <h2>Регламент радиообмена</h2>
                    </div>
                    <p>Правила и стандарты ведения радиообмена сотрудниками ГИБДД для обеспечения эффективной коммуникации.</p>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-exchange-alt"></i> Доклад о сдаче/заступлении на смену и о взятии перерыва</h3>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], заступил на смену.</div>
                            <div class="radio-desc">Доклад о начале смены</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], сдал смену.</div>
                            <div class="radio-desc">Доклад о завершении смены</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], разрешите взять перерыв на [минут]. [Причина].</div>
                            <div class="radio-desc">Запрос на перерыв</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], взял перерыв на [время].</div>
                            <div class="radio-desc">Уведомление о начале перерыва</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], вернулся с перерыва.</div>
                            <div class="radio-desc">Уведомление о возвращении с перерыва</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-car"></i> Доклады во время патрулирования на автомобиле</h3>
                        <p>Во время патрулирования используются такие аббревиатуры, как ПГ и ПЮ (ПГ / ПЮ - патрулирование города / юрисдикции)</p>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], А-ПГ-1, [Маркировка экипажа] - Выехали в патрулирование города.</div>
                            <div class="radio-desc">Начало патрулирования на автомобиле</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], А-ПГ-2, [Маркировка экипажа] - Патрулирование города, состояние стабильное.</div>
                            <div class="radio-desc">Доклад о стабильной обстановке</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], А-ПГ-3, [Маркировка экипажа] - Завершили патрулирование города.</div>
                            <div class="radio-desc">Завершение патрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], А-ПГ-4, [Маркировка экипажа], [Деятельность экипажа] - Доклад для указания деятельности экипажа.</div>
                            <div class="radio-desc">Доклад о текущей деятельности (если имеется напарник, указываете его позывной в конце доклада)</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-helicopter"></i> Доклады во время патрулирования на вертолёте</h3>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], В-ПЮ-1, Киров - Вылетели в патрулирование города.</div>
                            <div class="radio-desc">Начало патрулирования на вертолете</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], В-ПЮ-2, Киров - Патрулирование города, состояние стабильное.</div>
                            <div class="radio-desc">Доклад о стабильной обстановке с воздуха</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], В-ПЮ-3, Киров - Завершили патрулирование города.</div>
                            <div class="radio-desc">Завершение воздушного патрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], В-ПЮ-4, Киров, [Деятельность экипажа] - Доклад для указания деятельности экипажа.</div>
                            <div class="radio-desc">Доклад о текущей деятельности (если имеется напарник, указываете его позывной в конце доклада)</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-walking"></i> Доклады во время пешего патрулирования</h3>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], П-ПГ-1 - Вышли в патрулирование города.</div>
                            <div class="radio-desc">Начало пешего патрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], П-ПГ-2 - Патрулирование города, состояние стабильное.</div>
                            <div class="radio-desc">Доклад о стабильной обстановке при пешем патрулировании</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], П-ПГ-3 - Завершили патрулирование города.</div>
                            <div class="radio-desc">Завершение пешего патрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], П-ПГ-4, [Деятельность сотрудников] - Доклад для указания деятельности, если таковая имеется.</div>
                            <div class="radio-desc">Доклад о текущей деятельности (если имеется напарник, указываете его позывной в конце доклада)</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-motorcycle"></i> Доклады во время патрулирования на мотоцикле</h3>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], М-ПГ-1 - Выехали в мотопатрулирование города.</div>
                            <div class="radio-desc">Начало мотопатрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], М-ПГ-2 - Мотопатрулирование города, состояние стабильное.</div>
                            <div class="radio-desc">Доклад о стабильной обстановке при мотопатрулировании</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], М-ПГ-3 - Завершили мотопатрулирование города.</div>
                            <div class="radio-desc">Завершение мотопатрулирования</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], М-ПГ-4, [Деятельность сотрудников] - Доклад для указания деятельности, если таковая имеется.</div>
                            <div class="radio-desc">Доклад о текущей деятельности (если имеется напарник, указываете его позывной в конце доклада)</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-phone-alt"></i> Доклады во время принятия вызова</h3>
                        <p>Во время обработки вызова используется такая аббревиатура, как ОВ (ОВ - обработка вызова). Во время принятия вызова допускается использование таких фраз, как *принял(и) вызов*, а также им подобных.</p>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ОВ-1 [Локация вызова], [Маркировка экипажа].</div>
                            <div class="radio-desc">Принятие вызова</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ОВ-2, [Маркировка экипажа] - Прибыли на вызов, обрабатываете.</div>
                            <div class="radio-desc">Прибытие на место вызова (если вызов оказался ложным, этот доклад не используется)</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ОВ-3, [Маркировка экипажа] - Вызов обработан.</div>
                            <div class="radio-desc">Завершение обработки вызова</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-road"></i> Доклады во время нахождения на передвижных постах</h3>
                        <p>Во время дежурства на посту используется маркировка самого поста (номер поста, где *Х*), а также цифры, обозначающие состояние или действия сотрудника на том самом посту.</p>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ПП-[Х]-0, [Маркировка экипажа] - Выехали на пост.</div>
                            <div class="radio-desc">Выезд на пост</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ПП-[X]-1, [Маркировка экипажа] - Заступили на пост.</div>
                            <div class="radio-desc">Заступление на пост</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ПП-[Х]-2, [Маркировка экипажа] - Состояние на посту стабильное.</div>
                            <div class="radio-desc">Доклад о стабильной обстановке на посту</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ПП-[Х]-3, [Маркировка экипажа] - Сдали пост.</div>
                            <div class="radio-desc">Сдача поста</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ПП-[Х]-4, [Маркировка экипажа], [Деятельность сотрудников] - Доклад с указанием деятельности, если таковая имеется.</div>
                            <div class="radio-desc">Доклад о текущей деятельности (если имеется напарник, указываете его позывной в конце доклада)</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-user-secret"></i> Доклады во время отлова ООН (для ОСР)</h3>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], выехал(и) на поимку ООН. По базе данных: [Имя Фамилия нарушителя] - Начало отлова.</div>
                            <div class="radio-desc">Начало операции по задержанию особо опасного нарушителя</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="radio-syntax">[Позывной], ООН был нейтрализован. Произвожу(дим) конвоирование задержанного в отдел - Конец отлова.</div>
                            <div class="radio-desc">Завершение операции по задержанию</div>
                        </div>
                    </div>
                    
                    <div class="radio-category">
                        <h3><i class="fas fa-broadcast-tower"></i> Основные положения радиообмена</h3>
                        
                        <div class="radio-item">
                            <div class="label">Позывной</div>
                            <div class="value">Специальное слово, либо сочетание букв или цифр, которое присваивают сотрудникам ОГИБДД для опознания участников переговоров, а также с целью осуществления докладов о текущей деятельности сотрудника ОГИБДД. Позывные присваиваются в индивидуальном порядке руководящим составом отдела или начальником ДПС ОГИБДД по г. Приволжск.</div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="label">Формирование позывных</div>
                            <div class="value">
                                <ul>
                                    <li>Сотрудникам ОБ присваиваются позывные: ОБ-*, где * - любое натуральное число</li>
                                    <li>Сотрудникам УК присваиваются позывные: К-*, где * - любое натуральное число</li>
                                    <li>Сотрудникам ЦПС присваиваются позывные: И-*, где * - любое натуральное число</li>
                                    <li>Сотрудникам ОСР присваиваются любые именные позывные, которые не ограничены правилами четвёртого пункта</li>
                                    <li>Сотрудникам СК присваиваются позывные: С-1, С-2, С-3 - для стажёров-инспекторов ОСР; С-4, С-5, С-6 - для стажёров-инспекторов ОБ; С-7, С-8, С-9 - для стажёров-инструкторов ЦПС</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="label">Обязанности сотрудника</div>
                            <div class="value">
                                <ul>
                                    <li>Сотрудник обязан использовать свой позывной в начале каждого доклада или запроса о помощи в общую рацию сотрудников ОГИБДД-П</li>
                                    <li>Сотрудник обязан использовать тег "ОГИБДД-П" в начале докладов и/или запросов о помощи в общую рацию сотрудников МВД и общую рацию всех государственных организаций</li>
                                </ul>
                            </div>
                        </div>
                        
                        <div class="radio-item">
                            <div class="label">Запреты сотрудника</div>
                            <div class="value">
                                <ul>
                                    <li>Запрещено использовать позывной, который закреплён за другим сотрудником</li>
                                    <li>Запрещено использовать свою фамилию или фамилию напарника вместо позывного(-ых)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Jurisdiction Section -->
                <section id="jurisdiction-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-map-marked-alt"></i>
                        <h2>Юрисдикции структур МВД</h2>
                    </div>
                    <p>Распределение зон ответственности и юрисдикций между структурными подразделениями МВД в городах Республики Провинция.</p>
                    
                    <div class="jurisdiction-map">
                        <img src="https://sun9-60.userapi.com/impg/JaNeolWVlVb2GT0NnuraXZnz8ZNwkGOm24x1Sg/yt6KDQXk-F8.jpg?size=1280x1280&quality=96&sign=0370a9a83347001d3ef0f0aacd45e9d8&type=album" alt="Карта юрисдикций МВД" class="jurisdiction-image">
                        <p><strong>Легенда:</strong> Мирный - синий / Приволжск - Зеленый / Невский - Красный</p>
                    </div>
                    
                    <div class="jurisdiction-info">
                        <div class="jurisdiction-card mirny">
                            <h3><i class="fas fa-city"></i> Город Мирный</h3>
                            <div class="weapon-info">
                                <div class="label">Цвет обозначения:</div>
                                <div class="value" style="color: #3b82f6;">Синий</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Ответственные подразделения:</div>
                                <div class="value">
                                    <ul>
                                        <li>ОГИБДД по г. Мирный</li>
                                        <li>Отдел полиции №1 г. Мирный</li>
                                        <li>Патрульно-постовая служба г. Мирный</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Особенности юрисдикции:</div>
                                <div class="value">Город Мирный является административным центром региона. Здесь расположены ключевые государственные учреждения и дипломатические представительства. Сотрудники МВД в Мирном обеспечивают безопасность важных государственных объектов и дипломатического корпуса.</div>
                            </div>
                        </div>
                        
                        <div class="jurisdiction-card privolzhsk">
                            <h3><i class="fas fa-industry"></i> Город Приволжск</h3>
                            <div class="weapon-info">
                                <div class="label">Цвет обозначения:</div>
                                <div class="value" style="color: #10b981;">Зеленый</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Ответственные подразделения:</div>
                                <div class="value">
                                    <ul>
                                        <li>ОГИБДД по г. Приволжск</li>
                                        <li>Отдел полиции №2 г. Приволжск</li>
                                        <li>Отдел по борьбе с экономическими преступлениями</li>
                                        <li>Транспортная полиция</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Особенности юрисдикции:</div>
                                <div class="value">Приволжск - промышленный и транспортный узел региона. Основные задачи МВД в Приволжске - обеспечение безопасности на транспортных магистралях, охрана промышленных объектов и борьба с экономическими преступлениями.</div>
                            </div>
                        </div>
                        
                        <div class="jurisdiction-card nevsky">
                            <h3><i class="fas fa-university"></i> Город Невский</h3>
                            <div class="weapon-info">
                                <div class="label">Цвет обозначения:</div>
                                <div class="value" style="color: #ef4444;">Красный</div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Ответственные подразделения:</div>
                                <div class="value">
                                    <ul>
                                        <li>ОГИБДД по г. Невский</li>
                                        <li>Отдел полиции №3 г. Невский</li>
                                        <li>Отдел по борьбе с организованной преступностью</li>
                                        <li>Кинологическая служба</li>
                                    </ul>
                                </div>
                            </div>
                            <div class="weapon-info">
                                <div class="label">Особенности юрисдикции:</div>
                                <div class="value">Невский - культурный и исторический центр с развитой туристической инфраструктурой. Сотрудники МВД в Невском специализируются на обеспечении общественного порядка в местах массового скопления людей, охране культурных ценностей и борьбе с уличной преступностью.</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="map-description" style="margin-top: 30px;">
                        <h3><i class="fas fa-info-circle"></i> Взаимодействие между юрисдикциями</h3>
                        <p>Все подразделения МВД работают в тесном взаимодействии согласно единому плану оперативного реагирования. В случае возникновения чрезвычайных ситуаций или проведения масштабных операций, сотрудники разных юрисдикций могут быть временно переподчинены для выполнения общих задач.</p>
                        <p>Координацию совместных действий осуществляет Оперативный штаб МВД Республики Провинция, расположенный в г. Мирный.</p>
                    </div>
                </section>
                
                <!-- Map Section -->
                <section id="map-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-map"></i>
                        <h2>Карта постов</h2>
                    </div>
                    <p>Карта с расположением всех постов для патрулирования и контроля дорожного движения.</p>
                    
                    <div class="map-container">
                        <!-- Ваша карта постов -->
                        <img src="https://lh7-rt.googleusercontent.com/docsz/AD_4nXcOpJdcpV3DGQdJgU1dleoahP0emwSKqDDoaQF2dd7cB3Rg04zIwkYsxbXOEREAJBIKNzx9jvvE3LqX2jk5CC_DXFgLmlqF89loDME2Trcn2fkG5FnN67gvoThqfQpMlZw3tD5Qn-ZOfgtkFlgwGs4Q2B8?key=fuZgRRHThPhJ3hcp0pwv8g" alt="Карта постов ГИБДД" class="map-image">
                        
                        <div class="map-description">
                            <h3><i class="fas fa-info-circle"></i> Информация о постах</h3>
                            <p>Карта с расположением всех постов. Количество сотрудников на одном посту не ограничено.</p>
                            <p>На постах разрешено устанавливать специальные ограждения и заграждения, однако они должны быть установлены согласно приказу МВД.</p>
                        </div>
                    </div>
                </section>
                
                <!-- Statistics Section -->
                <section id="statistics-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-chart-bar"></i>
                        <h2>Статистика сотрудника</h2>
                    </div>
                    <p>Здесь отображается статистика и информация о сотруднике ГИБДД.</p>
                    
                    <div class="stats-grid">
                        <div class="stat-card">
                            <h3>Выдано штрафов</h3>
                            <div class="value" id="stat-fines">0</div>
                            <div class="label">Общее количество</div>
                            <div class="stat-controls">
                                <button class="btn btn-success" onclick="updateStat('fines', 1)"><i class="fas fa-plus"></i> +1</button>
                                <button class="btn btn-danger" onclick="updateStat('fines', -1)"><i class="fas fa-minus"></i> -1</button>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Задержано преступников</h3>
                            <div class="value" id="stat-arrests">0</div>
                            <div class="label">Общее количество</div>
                            <div class="stat-controls">
                                <button class="btn btn-success" onclick="updateStat('arrests', 1)"><i class="fas fa-plus"></i> +1</button>
                                <button class="btn btn-danger" onclick="updateStat('arrests', -1)"><i class="fas fa-minus"></i> -1</button>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Изъято прав</h3>
                            <div class="value" id="stat-licenses">0</div>
                            <div class="label">Общее количество</div>
                            <div class="stat-controls">
                                <button class="btn btn-success" onclick="updateStat('licenses', 1)"><i class="fas fa-plus"></i> +1</button>
                                <button class="btn btn-danger" onclick="updateStat('licenses', -1)"><i class="fas fa-minus"></i> -1</button>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Проведено досмотров</h3>
                            <div class="value" id="stat-searches">0</div>
                            <div class="label">Общее количество</div>
                            <div class="stat-controls">
                                <button class="btn btn-success" onclick="updateStat('searches', 1)"><i class="fas fa-plus"></i> +1</button>
                                <button class="btn btn-danger" onclick="updateStat('searches', -1)"><i class="fas fa-minus"></i> -1</button>
                            </div>
                        </div>
                        
                        <div class="stat-card">
                            <h3>Общий рейтинг</h3>
                            <div class="value" id="stat-rating">0</div>
                            <div class="label">Баллы эффективности</div>
                            <div class="stat-controls">
                                <button class="btn btn-success" onclick="updateStat('rating', 1)"><i class="fas fa-plus"></i> +1</button>
                                <button class="btn btn-danger" onclick="updateStat('rating', -1)"><i class="fas fa-minus"></i> -1</button>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Leaderboard Section -->
                <section id="leaderboard-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-trophy"></i>
                        <h2>Таблица лидеров</h2>
                    </div>
                    <p>Рейтинги сотрудников ГИБДД по различным показателям эффективности.</p>
                    
                    <div class="leaderboard-tabs">
                        <div class="leaderboard-tab active" onclick="showLeaderboard('fines')">Штрафы</div>
                        <div class="leaderboard-tab" onclick="showLeaderboard('arrests')">Задержания</div>
                        <div class="leaderboard-tab" onclick="showLeaderboard('licenses')">Изъятия прав</div>
                        <div class="leaderboard-tab" onclick="showLeaderboard('searches')">Досмотры</div>
                    </div>
                    
                    <div id="leaderboard-fines" class="leaderboard-content">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Место</th>
                                    <th>Сотрудник</th>
                                    <th>Количество штрафов</th>
                                    <th>Звание</th>
                                    <th>Фракция</th>
                                </tr>
                            </thead>
                            <tbody id="fines-leaderboard">
                                <!-- Данные будут заполнены JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="leaderboard-arrests" class="leaderboard-content" style="display: none;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Место</th>
                                    <th>Сотрудник</th>
                                    <th>Задержания</th>
                                    <th>Звание</th>
                                    <th>Фракция</th>
                                </tr>
                            </thead>
                            <tbody id="arrests-leaderboard">
                                <!-- Данные будут заполнены JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="leaderboard-licenses" class="leaderboard-content" style="display: none;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Место</th>
                                    <th>Сотрудник</th>
                                    <th>Изъятия прав</th>
                                    <th>Звание</th>
                                    <th>Фракция</th>
                                </tr>
                            </thead>
                            <tbody id="licenses-leaderboard">
                                <!-- Данные будут заполнены JavaScript -->
                            </tbody>
                        </table>
                    </div>
                    
                    <div id="leaderboard-searches" class="leaderboard-content" style="display: none;">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Место</th>
                                    <th>Сотрудник</th>
                                    <th>Досмотры</th>
                                    <th>Звание</th>
                                    <th>Фракция</th>
                                </tr>
                            </thead>
                            <tbody id="searches-leaderboard">
                                <!-- Данные будут заполнены JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </section>
                
                <!-- Profile Section -->
                <section id="profile-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-user"></i>
                        <h2>Профиль сотрудника</h2>
                    </div>
                    <p>Личная информация и статистика сотрудника.</p>
                    
                    <div class="profile-info">
                        <div class="profile-card">
                            <h3><i class="fas fa-id-card"></i> Основная информация</h3>
                            <div class="profile-field">
                                <span class="label">Игровой ник:</span>
                                <span class="value" id="profile-nickname">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Звание:</span>
                                <span class="value" id="profile-rank">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Должность:</span>
                                <span class="value" id="profile-position">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Фракция:</span>
                                <span class="value" id="profile-fraction">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Город:</span>
                                <span class="value" id="profile-city">-</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Статус:</span>
                                <span class="value" id="profile-status">-</span>
                            </div>
                        </div>
                        
                        <div class="profile-card">
                            <h3><i class="fas fa-chart-line"></i> Статистика службы</h3>
                            <div class="profile-field">
                                <span class="label">Выдано штрафов:</span>
                                <span class="value" id="profile-fines">0</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Задержано преступников:</span>
                                <span class="value" id="profile-arrests">0</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Изъято прав:</span>
                                <span class="value" id="profile-licenses">0</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Проведено досмотров:</span>
                                <span class="value" id="profile-searches">0</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Общий рейтинг:</span>
                                <span class="value" id="profile-rating">0</span>
                            </div>
                            <div class="profile-field">
                                <span class="label">Дата регистрации:</span>
                                <span class="value" id="profile-regdate">-</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Settings Section -->
                <section id="settings-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-cog"></i>
                        <h2>Настройки и кастомизация</h2>
                    </div>
                    <p>Настройте внешний вид и параметры вашего аккаунта.</p>
                    
                    <div class="settings-grid">
                        <div class="setting-card">
                            <h3><i class="fas fa-user-cog"></i> Настройки аккаунта</h3>
                            
                            <div class="setting-option">
                                <div class="setting-label">Смена пароля</div>
                                <div class="setting-description">Измените пароль для входа в систему</div>
                                <button class="btn btn-outline" onclick="showChangePasswordModal()"><i class="fas fa-lock"></i> Сменить пароль</button>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Смена никнейма</div>
                                <div class="setting-description">Измените отображаемое имя</div>
                                <button class="btn btn-outline" onclick="showChangeNicknameModal(false)"><i class="fas fa-user-edit"></i> Сменить никнейм</button>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Звание и должность</div>
                                <div class="setting-description">Выберите ваше звание и должность в организации</div>
                                <button class="btn btn-outline" onclick="showRankPositionModal(false)"><i class="fas fa-user-tie"></i> Выбрать звание/должность</button>
                            </div>
                        </div>
                        
                        <div class="setting-card">
                            <h3><i class="fas fa-palette"></i> Внешний вид</h3>
                            
                            <div class="setting-option">
                                <div class="setting-label">Тема оформления</div>
                                <div class="setting-description">Выберите светлую или темную тему</div>
                                <div style="display: flex; gap: 10px;">
                                    <button class="btn btn-outline" onclick="setTheme(false)" id="lightThemeBtn"><i class="fas fa-sun"></i> Светлая</button>
                                    <button class="btn btn-outline" onclick="setTheme(true)" id="darkThemeBtn"><i class="fas fa-moon"></i> Темная</button>
                                </div>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Размер шрифта</div>
                                <div class="setting-description">Настройте размер текста для комфортного чтения</div>
                                <select id="fontSize" class="form-control" onchange="updateFontSize(this.value)">
                                    <option value="small">Маленький</option>
                                    <option value="medium" selected>Средний</option>
                                    <option value="large">Большой</option>
                                </select>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Компактный режим</div>
                                <div class="setting-description">Уменьшите отступы для большего количества информации на экране</div>
                                <label class="switch">
                                    <input type="checkbox" id="compactMode" onchange="toggleCompactMode(this.checked)">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="setting-card">
                            <h3><i class="fas fa-bell"></i> Уведомления</h3>
                            
                            <div class="setting-option">
                                <div class="setting-label">Email уведомления</div>
                                <div class="setting-description">Получать уведомления на электронную почту</div>
                                <label class="switch">
                                    <input type="checkbox" id="emailNotifications" onchange="updateNotificationSettings()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Обновления системы</div>
                                <div class="setting-description">Уведомлять о новых функциях и обновлениях</div>
                                <label class="switch">
                                    <input type="checkbox" id="systemUpdates" onchange="updateNotificationSettings()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">Статистика активности</div>
                                <div class="setting-description">Еженедельный отчет о вашей активности</div>
                                <label class="switch">
                                    <input type="checkbox" id="weeklyReports" onchange="updateNotificationSettings()">
                                    <span class="slider"></span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="setting-card">
                            <h3><i class="fas fa-shield-alt"></i> Безопасность</h3>
                            
                            <div class="setting-option">
                                <div class="setting-label">Двухфакторная аутентификация</div>
                                <div class="setting-description">Дополнительная защита вашего аккаунта</div>
                                <button class="btn btn-outline" onclick="enableTwoFactorAuth()"><i class="fas fa-mobile-alt"></i> Включить 2FA</button>
                            </div>
                            
                            <div class="setting-option">
                                <div class="setting-label">История входов</div>
                                <div class="setting-description">Просмотр последних активностей вашего аккаунта</div>
                                <button class="btn btn-outline" onclick="showLoginHistory()"><i class="fas fa-history"></i> Показать историю</button>
                            </div>
                            
                            <div class="danger-zone">
                                <h4><i class="fas fa-exclamation-triangle"></i> Опасная зона</h4>
                                <div class="setting-description">Эти действия нельзя отменить</div>
                                <button class="btn btn-danger" onclick="showDeleteAccountModal()"><i class="fas fa-trash"></i> Удалить аккаунт</button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Административные настройки (только для админов) -->
                    <div id="adminSettings" style="display: none; margin-top: 30px;">
                        <div class="section-title">
                            <i class="fas fa-user-shield"></i>
                            <h2>Административные настройки</h2>
                        </div>
                        
                        <div class="settings-grid">
                            <div class="setting-card">
                                <h3><i class="fas fa-users-cog"></i> Управление пользователями</h3>
                                
                                <div class="setting-option">
                                    <div class="setting-label">Смена никнеймов</div>
                                    <div class="setting-description">Изменить никнейм любому пользователю</div>
                                    <button class="btn btn-warning" onclick="showChangeNicknameModal(true)"><i class="fas fa-user-edit"></i> Сменить никнейм</button>
                                </div>
                                
                                <div class="setting-option">
                                    <div class="setting-label">Назначение званий</div>
                                    <div class="setting-description">Назначить звание и должность пользователям</div>
                                    <button class="btn btn-warning" onclick="showRankPositionModal(true)"><i class="fas fa-user-tie"></i> Назначить звание</button>
                                </div>
                            </div>
                            
                            <div class="setting-card">
                                <h3><i class="fas fa-chart-line"></i> Управление статистикой</h3>
                                
                                <div class="setting-option">
                                    <div class="setting-label">Редактирование статистики</div>
                                    <div class="setting-description">Изменение статистики любого пользователя</div>
                                    <button class="btn btn-warning" onclick="showEditStatsModal()"><i class="fas fa-edit"></i> Редактировать статистику</button>
                                </div>
                                
                                <div class="setting-option">
                                    <div class="setting-label">Сброс статистики</div>
                                    <div class="setting-description">Обнуление статистики пользователей</div>
                                    <button class="btn btn-danger" onclick="showResetStatsModal()"><i class="fas fa-eraser"></i> Сбросить статистику</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Admin Section -->
                <section id="admin-section" class="content-section" style="display: none;">
                    <div class="section-title">
                        <i class="fas fa-cogs"></i>
                        <h2>Административная панель</h2>
                    </div>
                    <p>Управление пользователями, назначение администраторов и другие административные функции.</p>
                    
                    <div class="admin-tabs">
                        <div class="admin-tab active" onclick="showAdminTab('users')">Пользователи</div>
                        <div class="admin-tab" onclick="showAdminTab('admins')">Администраторы</div>
                        <div class="admin-tab" onclick="showAdminTab('bans')">Баны</div>
                    </div>
                    
                    <!-- Вкладка управления пользователями -->
                    <div id="admin-users" class="admin-tab-content active">
                        <div class="admin-controls">
                            <div class="admin-card">
                                <h3><i class="fas fa-edit"></i> Изменить данные пользователя</h3>
                                <div class="form-group">
                                    <label for="editUser">Пользователь</label>
                                    <select id="editUser" class="form-control">
                                        <!-- Список пользователей будет заполнен JavaScript -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="editFraction">Фракция</label>
                                    <select id="editFraction" class="form-control">
                                        <option value="ГИБДД">ГИБДД</option>
                                        <option value="ГИБДД Невского">ГИБДД Невского</option>
                                        <option value="ГИБДД Мирного">ГИБДД Мирного</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="editCity">Город</label>
                                    <select id="editCity" class="form-control">
                                        <option value="Приволжск">Приволжск</option>
                                        <option value="Невский">Невский</option>
                                        <option value="Мирный">Мирный</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="editRank">Звание</label>
                                    <select id="editRank" class="form-control">
                                        <option value="Рядовой">Рядовой</option>
                                        <option value="Сержант">Сержант</option>
                                        <option value="Старшина">Старшина</option>
                                        <option value="Прапорщик">Прапорщик</option>
                                        <option value="Лейтенант">Лейтенант</option>
                                        <option value="Старший лейтенант">Старший лейтенант</option>
                                        <option value="Капитан">Капитан</option>
                                        <option value="Майор">Майор</option>
                                        <option value="Подполковник">Подполковник</option>
                                        <option value="Полковник">Полковник</option>
                                        <option value="Генерал">Генерал</option>
                                        <option value="Следящий за фракцией">Следящий за фракцией</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="editPosition">Должность</label>
                                    <input type="text" id="editPosition" class="form-control" placeholder="Введите должность">
                                </div>
                                <button class="btn" onclick="saveUserChanges()"><i class="fas fa-save"></i> Сохранить изменения</button>
                            </div>
                            
                            <div class="admin-card">
                                <h3><i class="fas fa-user-shield"></i> Назначить администратора</h3>
                                <div class="form-group">
                                    <label for="adminUser">Пользователь</label>
                                    <select id="adminUser" class="form-control">
                                        <!-- Список пользователей будет заполнен JavaScript -->
                                    </select>
                                </div>
                                <button class="btn btn-warning" onclick="assignAdmin()"><i class="fas fa-user-cog"></i> Назначить администратором</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <h3><i class="fas fa-users"></i> Список пользователей</h3>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Никнейм</th>
                                        <th>Звание</th>
                                        <th>Должность</th>
                                        <th>Фракция</th>
                                        <th>Город</th>
                                        <th>Статус</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="usersTable">
                                    <!-- Данные будут заполнены JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Вкладка управления администраторами -->
                    <div id="admin-admins" class="admin-tab-content" style="display: none;">
                        <div class="admin-controls">
                            <div class="admin-card">
                                <h3><i class="fas fa-user-times"></i> Снять права администратора</h3>
                                <div class="form-group">
                                    <label for="removeAdminUser">Администратор</label>
                                    <select id="removeAdminUser" class="form-control">
                                        <!-- Список администраторов будет заполнен JavaScript -->
                                    </select>
                                </div>
                                <button class="btn btn-danger" onclick="removeAdmin()"><i class="fas fa-user-slash"></i> Снять права</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <h3><i class="fas fa-user-shield"></i> Список администраторов</h3>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Никнейм</th>
                                        <th>Звание</th>
                                        <th>Должность</th>
                                        <th>Фракция</th>
                                        <th>Город</th>
                                        <th>Уровень доступа</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="adminsTable">
                                    <!-- Данные будут заполнены JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <!-- Вкладка управления банами -->
                    <div id="admin-bans" class="admin-tab-content" style="display: none;">
                        <div class="admin-controls">
                            <div class="admin-card">
                                <h3><i class="fas fa-ban"></i> Заблокировать пользователя</h3>
                                <div class="form-group">
                                    <label for="banUser">Пользователь</label>
                                    <select id="banUser" class="form-control">
                                        <!-- Список пользователей будет заполнен JavaScript -->
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="banReason">Причина блокировки</label>
                                    <input type="text" id="banReason" class="form-control" placeholder="Введите причину">
                                </div>
                                <div class="form-group">
                                    <label for="banDuration">Срок блокировки (дни)</label>
                                    <input type="number" id="banDuration" class="form-control" placeholder="0 для перманентного бана" min="0">
                                </div>
                                <button class="btn btn-danger" onclick="banUser()"><i class="fas fa-ban"></i> Заблокировать</button>
                            </div>
                            
                            <div class="admin-card">
                                <h3><i class="fas fa-check-circle"></i> Разблокировать пользователя</h3>
                                <div class="form-group">
                                    <label for="unbanUser">Заблокированный пользователь</label>
                                    <select id="unbanUser" class="form-control">
                                        <!-- Список заблокированных пользователей будет заполнен JavaScript -->
                                    </select>
                                </div>
                                <button class="btn btn-success" onclick="unbanUser()"><i class="fas fa-unlock"></i> Разблокировать</button>
                            </div>
                        </div>
                        
                        <div style="margin-top: 30px;">
                            <h3><i class="fas fa-gavel"></i> Список заблокированных пользователей</h3>
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Никнейм</th>
                                        <th>Причина</th>
                                        <th>Дата блокировки</th>
                                        <th>Дата разблокировки</th>
                                        <th>Заблокировал</th>
                                        <th>Действия</th>
                                    </tr>
                                </thead>
                                <tbody id="bansTable">
                                    <!-- Данные будут заполнены JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div>
            
            <!-- Sidebar -->
            <div class="sidebar">
                <div class="stats-card">
                    <h3><i class="fas fa-chart-pie"></i> Моя статистика</h3>
                    <div class="stat-item">
                        <span>Выдано штрафов</span>
                        <span class="stat-value" id="sidebar-fines">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Задержано преступников</span>
                        <span class="stat-value" id="sidebar-arrests">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Изъято прав</span>
                        <span class="stat-value" id="sidebar-licenses">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Проведено досмотров</span>
                        <span class="stat-value" id="sidebar-searches">0</span>
                    </div>
                    <div class="stat-item">
                        <span>Рейтинговый балл</span>
                        <span class="stat-value" id="sidebar-rating">0</span>
                    </div>
                </div>
                
                <div class="quick-links">
                    <h3><i class="fas fa-link"></i> Быстрые ссылки</h3>
                    <ul class="links-list">
                        <li><a href="https://forum.gtaprovince.ru" target="_blank"><i class="fas fa-globe"></i> Официальный форум</a></li>
                        <li><a href="https://forum.gtaprovince.ru/forum/1767-zakonodatelnaya-baza/" target="_blank"><i class="fas fa-book"></i> База знаний</a></li>
                        <li><a href="#" onclick="showSection('binds')"><i class="fas fa-keyboard"></i> Бинды для игры</a></li>
                        <li><a href="#" onclick="showSection('commands')"><i class="fas fa-terminal"></i> Игровые команды</a></li>
                        <li><a href="#" onclick="showSection('documents')"><i class="fas fa-file-alt"></i> Нормативные документы</a></li>
                        <li><a href="#" onclick="showSection('map')"><i class="fas fa-map"></i> Карта постов</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </main>
    
    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>ГИБДД Республики Провинция</h3>
                    <p>Официальный сайт дорожно-патрульной службы для сотрудников фракции в MTA Province.</p>
                </div>
                
                <div class="footer-section">
                    <h3>Разделы сайта</h3>
                    <ul class="footer-links">
                        <li><a href="#" onclick="showSection('dashboard')"><i class="fas fa-tachometer-alt"></i> Главная</a></li>
                        <li><a href="#" onclick="showSection('binds')"><i class="fas fa-keyboard"></i> Бинды</a></li>
                        <li><a href="#" onclick="showSection('commands')"><i class="fas fa-terminal"></i> Команды</a></li>
                        <li><a href="#" onclick="showSection('documents')"><i class="fas fa-file-alt"></i> Документы</a></li>
                        <li><a href="#" onclick="showSection('map')"><i class="fas fa-map"></i> Карта постов</a></li>
                    </ul>
                </div>
                
                <div class="footer-section">
                    <h3>Полезные ресурсы</h3>
                    <ul class="footer-links">
                        <li><a href="https://forum.gtaprovince.ru" target="_blank"><i class="fas fa-globe"></i> Официальный форум</a></li>
                        <li><a href="https://forum.gtaprovince.ru/forum/1767-zakonodatelnaya-baza/" target="_blank"><i class="fas fa-book"></i> База знаний</a></li>
                        <li><a href="#" onclick="alert('Раздел в разработке')"><i class="fas fa-graduation-cap"></i> Обучение для новичков</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="copyright">
                made by <a href="https://vk.com/alexandro_vorobyev" target="_blank">Alexander_Vorobyev</a>
            </div>
        </div>
    </footer>

    <script>
        // ==================== КОНФИГУРАЦИЯ SUPABASE ====================
        const SUPABASE_URL = 'https://vosimalhgssrwebzdtod.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZvc2ltYWxoZ3NzcndlYnpkdG9kIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjM5ODg0NDgsImV4cCI6MjA3OTU2NDQ0OH0.ypMMMoJ6RMQHdP7DKAJX76aEjKRILPQvd3uB8mCjn28';

        // Инициализация Supabase
        const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // ==================== СИСТЕМА РОЛЕЙ ====================
        const PERMISSION_LEVELS = {
          USER: 0,
          HELPER: 1,
          MODERATOR: 2,
          ADMIN: 3,
          SUPER_ADMIN: 4
        };

        const ROLES = {
          USER: { 
            level: 0, 
            name: "Гражданский", 
            permissions: ['view_own_stats', 'edit_own_stats', 'view_binds', 'view_commands', 'view_documents', 'view_map'] 
          },
          HELPER: { 
            level: 1, 
            name: "Помощник", 
            permissions: ['view_own_stats', 'edit_own_stats', 'view_binds', 'view_commands', 'view_documents', 'view_map', 'view_all_stats', 'view_users'] 
          },
          MODERATOR: { 
            level: 2, 
            name: "Модератор", 
            permissions: ['view_own_stats', 'edit_own_stats', 'view_binds', 'view_commands', 'view_documents', 'view_map', 'view_all_stats', 'view_users', 'ban_users', 'edit_stats', 'view_logs'] 
          },
          ADMIN: { 
            level: 3, 
            name: "Администратор", 
            permissions: ['view_own_stats', 'edit_own_stats', 'view_binds', 'view_commands', 'view_documents', 'view_map', 'view_all_stats', 'view_users', 'ban_users', 'edit_stats', 'view_logs', 'manage_users', 'assign_roles', 'system_settings'] 
          },
          SUPER_ADMIN: { 
            level: 4, 
            name: "Главный Администратор", 
            permissions: ['all'] 
          }
        };

        const SUPER_ADMINS = [
          { username: "Alexander_Vorobyev", email: "alexandro_vorobyev@vk.com" }
        ];

        // Глобальные переменные
        let currentUser = null;
        let currentUserStats = null;
        let allUsers = [];

        // ==================== ФУНКЦИИ АВТОРИЗАЦИИ ====================

        // Хеширование пароля
        async function hashPassword(password) {
          const encoder = new TextEncoder();
          const data = encoder.encode(password);
          const hash = await crypto.subtle.digest('SHA-256', data);
          return Array.from(new Uint8Array(hash))
            .map(b => b.toString(16).padStart(2, '0'))
            .join('');
        }

        // Проверка является ли пользователь суперадмином
        function isSuperAdmin(userData) {
          return SUPER_ADMINS.some(sa => 
            sa.username === userData.username || 
            sa.email === userData.email
          );
        }

// Регистрация пользователя
async function registerUser(userData) {
  try {
    // Проверяем, нет ли уже пользователя с таким логином или email
    const { data: existingUsers, error: checkError } = await supabase
      .from('users')
      .select('id')
      .or(`username.eq.${userData.username},email.eq.${userData.email}`);

    if (checkError) throw checkError;
    if (existingUsers && existingUsers.length > 0) {
      throw new Error('Пользователь с таким логином или email уже существует');
    }

    // Создаем пользователя
    const { data: user, error } = await supabase
      .from('users')
      .insert([{
        nickname: userData.nickname,
        username: userData.username,
        email: userData.email,
        password_hash: await hashPassword(userData.password),
        role: isSuperAdmin(userData) ? 'SUPER_ADMIN' : 'USER',
        rank: 'Гражданский',
        position: '',
        fraction: '',
        city: 'Приvolжск'
      }])
      .select()
      .single();

    if (error) throw error;

    // Создаем запись статистики
    const { error: statsError } = await supabase
      .from('user_stats')
      .insert([{
        user_id: user.id,
        fines: 0,
        arrests: 0,
        licenses: 0,
        searches: 0,
        rating: 0
      }]);

    if (statsError) throw statsError;

    // Автоматически логиним пользователя после регистрации
    const loginResult = await loginUser(userData.username, userData.password);
    return loginResult;

  } catch (error) {
    console.error('Registration error:', error);
    return { success: false, error: error.message };
  }
}

// Вход пользователя
async function loginUser(login, password) {
  try {
    // Ищем пользователя
    const { data: user, error } = await supabase
      .from('users')
      .select('*, two_factor_enabled, two_factor_secret') // ДОБАВЬТЕ ЭТО
      .or(`username.eq.${login},email.eq.${login}`)
      .single();

    if (error) throw error;

    // Проверяем пароль
    const isPasswordValid = await hashPassword(password) === user.password_hash;
    if (!isPasswordValid) throw new Error('Неверный пароль');

    // Проверяем бан
    if (user.banned && user.ban_expires && new Date(user.ban_expires) > new Date()) {
      throw new Error(`Аккаунт заблокирован. Причина: ${user.ban_reason}. Разблокировка: ${new Date(user.ban_expires).toLocaleDateString()}`);
    }

    // Если бан истек, разблокируем
    if (user.banned && user.ban_expires && new Date(user.ban_expires) <= new Date()) {
      await supabase
        .from('users')
        .update({ 
          banned: false, 
          ban_reason: null, 
          ban_expires: null, 
          banned_by: null 
        })
        .eq('id', user.id);
      user.banned = false;
    }

    // Сохраняем пользователя в localStorage
    localStorage.setItem('currentUser', JSON.stringify(user));
    
    return { success: true, user };
  } catch (error) {
    console.error('Login error:', error);
    return { success: false, error: error.message };
  }
}
        // Проверка авторизации
        async function checkAuth() {
            async function checkAuth() {
  const storedUser = localStorage.getItem('currentUser');
  if (!storedUser) return null;

  try {
    const user = JSON.parse(storedUser);
    
    // Получаем свежие данные пользователя включая 2FA статус
    const { data: freshUser, error } = await supabase
      .from('users')
      .select('*, two_factor_enabled, two_factor_secret') // ДОБАВЬТЕ ЭТИ ПОЛЯ
      .eq('id', user.id)
      .single();

    if (error) throw error;
    return freshUser;
  } catch (error) {
    console.error('Auth check error:', error);
    return null;
  }
}
          const storedUser = localStorage.getItem('currentUser');
          if (!storedUser) return null;

          try {
            const user = JSON.parse(storedUser);
            
            // Проверяем, актуальны ли данные пользователя
            const { data: freshUser, error } = await supabase
              .from('users')
              .select('*')
              .eq('id', user.id)
              .single();

            if (error) throw error;

            // Если пользователь забанен, выходим
            if (freshUser.banned && freshUser.ban_expires && new Date(freshUser.ban_expires) > new Date()) {
              localStorage.removeItem('currentUser');
              return null;
            }

            return freshUser;
          } catch (error) {
            localStorage.removeItem('currentUser');
            return null;
          }
        }

        // Выход
        function logout() {
          localStorage.removeItem('currentUser');
          currentUser = null;
          currentUserStats = null;
          location.reload();
        }

        // ==================== ФУНКЦИИ СТАТИСТИКИ ====================

        // Получение статистики пользователя
        async function getUserStats(userId) {
          try {
            const { data, error } = await supabase
              .from('user_stats')
              .select('*')
              .eq('user_id', userId)
              .single();

            return error ? null : data;
          } catch (error) {
            console.error('Get stats error:', error);
            return null;
          }
        }

        // Обновление статистики
        async function updateUserStats(userId, statType, value) {
          try {
            // Сначала получаем текущую статистику
            const currentStats = await getUserStats(userId);
            if (!currentStats) return false;

            // Обновляем нужное поле
            const updatedStats = { ...currentStats };
            updatedStats[statType] = Math.max(0, currentStats[statType] + value);
            updatedStats.updated_at = new Date().toISOString();

            // Обновляем в базе
            const { error } = await supabase
              .from('user_stats')
              .update(updatedStats)
              .eq('user_id', userId);

            if (error) throw error;

            return true;
          } catch (error) {
            console.error('Update stats error:', error);
            return false;
          }
        }

        // Получение таблицы лидеров
        async function getLeaderboard(type = 'fines', limit = 50) {
          try {
            const { data, error } = await supabase
              .from('user_stats')
              .select(`
                fines, arrests, licenses, searches, rating,
                users (id, nickname, rank, fraction, city, banned)
              `)
              .not('users.banned', 'is', true)
              .order(type, { ascending: false })
              .limit(limit);

            return error ? [] : data;
          } catch (error) {
            console.error('Leaderboard error:', error);
            return [];
          }
        }

        // ==================== АДМИНИСТРАТИВНЫЕ ФУНКЦИИ ====================

        // Получение всех пользователей
        async function getAllUsers() {
          try {
            const { data, error } = await supabase
              .from('users')
              .select('*, user_stats (fines, arrests, licenses, searches, rating)')
              .order('created_at', { ascending: false });

            if (error) throw error;
            return data || [];
          } catch (error) {
            console.error('Get users error:', error);
            return [];
          }
        }

        // Обновление данных пользователя
        async function updateUserInDatabase(userId, userData) {
          try {
            const { error } = await supabase
              .from('users')
              .update({
                ...userData,
                updated_at: new Date().toISOString()
              })
              .eq('id', userId);

            return !error;
          } catch (error) {
            console.error('Update user error:', error);
            return false;
          }
        }

        // Функция для обработки формы
        async function saveUserChanges() {
          if (!requirePermission('manage_users')) return;
          
          const userId = parseInt(document.getElementById('editUser').value);
          const fraction = document.getElementById('editFraction').value;
          const city = document.getElementById('editCity').value;
          const rank = document.getElementById('editRank').value;
          const position = document.getElementById('editPosition').value;
          
          if (!userId) {
            showError('Выберите пользователя');
            return;
          }
          
          try {
            const success = await updateUserInDatabase(userId, {
              fraction,
              city,
              rank,
              position
            });
            
            if (success) {
              alert('✅ Данные пользователя обновлены!');
              loadUsersForAdmin();
              logAdminAction('update_user_data', userId, `Обновлены данные: ${fraction}, ${city}, ${rank}, ${position}`);
            } else {
              showError('Ошибка при обновлении данных');
            }
          } catch (error) {
            console.error('Error updating user data:', error);
            showError('Ошибка при обновлении данных');
          }
        }

        // Блокировка пользователя
        async function banUserInDatabase(userId, reason, durationDays = 0, adminName) {
          try {
            const banExpires = durationDays > 0 ? 
              new Date(Date.now() + durationDays * 24 * 60 * 60 * 1000).toISOString() : 
              null;

            const { error } = await supabase
              .from('users')
              .update({
                banned: true,
                ban_reason: reason,
                ban_expires: banExpires,
                banned_by: adminName,
                updated_at: new Date().toISOString()
              })
              .eq('id', userId);

            return !error;
          } catch (error) {
            console.error('Ban user error:', error);
            return false;
          }
        }

        // Разблокировка пользователя
        async function unbanUserInDatabase(userId) {
          try {
            const { error } = await supabase
              .from('users')
              .update({
                banned: false,
                ban_reason: null,
                ban_expires: null,
                banned_by: null,
                updated_at: new Date().toISOString()
              })
              .eq('id', userId);

            return !error;
          } catch (error) {
            console.error('Unban user error:', error);
            return false;
          }
        }

        // Логирование действий
        async function logAdminAction(action, target = null, details = '') {
          if (!currentUser) return true;

          try {
            const { error } = await supabase
              .from('admin_logs')
              .insert([{
                admin_id: currentUser.id,
                admin_name: currentUser.nickname,
                admin_role: currentUser.role,
                action: action,
                target: target,
                details: details,
                timestamp: new Date().toISOString()
              }]);

            return !error;
          } catch (error) {
            console.error('Log action error:', error);
            return false;
          }
        }

        // ==================== ПРОВЕРКА ПРАВ ====================

        function hasPermission(user, permission) {
          if (!user) return false;
          if (user.role === 'SUPER_ADMIN' || isSuperAdmin(user)) return true;
          
          const role = ROLES[user.role];
          return role && (role.permissions.includes(permission) || role.permissions.includes('all'));
        }

        function requirePermission(permission) {
          if (!hasPermission(currentUser, permission)) {
            showError('Недостаточно прав для выполнения этого действия');
            return false;
          }
          return true;
        }

        function showError(message) {
          alert('❌ ' + message);
        }

        // ==================== ИНИЦИАЛИЗАЦИЯ И UI ====================

        let isDarkTheme = localStorage.getItem('darkTheme') === 'true';

        // Применение темы
        function applyTheme() {
          if (isDarkTheme) {
            document.body.classList.add('dark-theme');
            document.getElementById('themeToggle').textContent = '☀️';
          } else {
            document.body.classList.remove('dark-theme');
            document.getElementById('themeToggle').textContent = '🌙';
          }
        }

        // Показать/скрыть модальное окно авторизации
        function showAuthModal() {
          document.getElementById('authModal').style.display = 'flex';
        }

        function hideAuthModal() {
          document.getElementById('authModal').style.display = 'none';
        }

        // Переключение между формами входа и регистрации
        function showAuthForm(formType) {
          document.getElementById('loginForm').classList.remove('active');
          document.getElementById('registerForm').classList.remove('active');
          document.querySelectorAll('.auth-tab').forEach(tab => tab.classList.remove('active'));
          
          if (formType === 'login') {
            document.getElementById('loginForm').classList.add('active');
            document.querySelectorAll('.auth-tab')[0].classList.add('active');
          } else {
            document.getElementById('registerForm').classList.add('active');
            document.querySelectorAll('.auth-tab')[1].classList.add('active');
          }
        }

        // Обновление интерфейса пользователя
        async function updateUserInterface() {
          if (!currentUser) return;

          // Получаем свежую статистику
          currentUserStats = await getUserStats(currentUser.id);

          // Обновляем UI
          document.querySelector('.user-name').textContent = currentUser.nickname;
          
          let displayRank = currentUser.rank;
          let statusBadge = '';
          
          if (isSuperAdmin(currentUser)) {
            statusBadge = '<span class="super-admin-badge">ГЛАВНЫЙ АДМИН</span>';
            displayRank = 'Главный Администратор';
          } else if (currentUser.role === 'ADMIN') {
            statusBadge = '<span class="admin-badge">АДМИН</span>';
          } else if (currentUser.role === 'MODERATOR') {
            statusBadge = '<span class="admin-badge" style="background: #f59e0b;">МОДЕРАТОР</span>';
          } else if (currentUser.role === 'HELPER') {
            statusBadge = '<span class="admin-badge" style="background: #10b981;">ПОМОЩНИК</span>';
          }
          
          document.querySelector('.user-rank').innerHTML = displayRank + statusBadge;
          document.querySelector('.user-avatar').textContent = currentUser.nickname.charAt(0).toUpperCase();

          // Обновляем статистику в сайдбаре
          if (currentUserStats) {
            document.getElementById('sidebar-fines').textContent = currentUserStats.fines;
            document.getElementById('sidebar-arrests').textContent = currentUserStats.arrests;
            document.getElementById('sidebar-licenses').textContent = currentUserStats.licenses;
            document.getElementById('sidebar-searches').textContent = currentUserStats.searches;
            document.getElementById('sidebar-rating').textContent = currentUserStats.rating;

            document.getElementById('stat-fines').textContent = currentUserStats.fines;
            document.getElementById('stat-arrests').textContent = currentUserStats.arrests;
            document.getElementById('stat-licenses').textContent = currentUserStats.licenses;
            document.getElementById('stat-searches').textContent = currentUserStats.searches;
            document.getElementById('stat-rating').textContent = currentUserStats.rating;
          }

          // Показываем/скрываем админ-панель
          if (hasPermission(currentUser, 'view_users')) {
            document.getElementById('adminTab').style.display = 'block';
          } else {
            document.getElementById('adminTab').style.display = 'none';
          }

          document.getElementById('profileTab').style.display = 'block';
          document.getElementById('settingsTab').style.display = 'block';
        }

        // Обновление информации в профиле
        function updateProfileInfo() {
          if (!currentUser || !currentUserStats) return;

          document.getElementById('profile-nickname').textContent = currentUser.nickname;
          document.getElementById('profile-rank').textContent = currentUser.rank;
          document.getElementById('profile-position').textContent = currentUser.position;
          document.getElementById('profile-fraction').textContent = currentUser.fraction;
          document.getElementById('profile-city').textContent = currentUser.city;
          
          let status = 'Активен';
          if (currentUser.banned) {
            status = 'Заблокирован';
          } else if (isSuperAdmin(currentUser)) {
            status = 'Главный Администратор';
          } else if (currentUser.role === 'ADMIN') {
            status = 'Администратор';
          } else if (currentUser.role === 'MODERATOR') {
            status = 'Модератор';
          } else if (currentUser.role === 'HELPER') {
            status = 'Помощник';
          } else if (currentUser.role === 'USER') {
            status = 'Гражданский';
          }
          document.getElementById('profile-status').textContent = status;
          
          document.getElementById('profile-fines').textContent = currentUserStats.fines;
          document.getElementById('profile-arrests').textContent = currentUserStats.arrests;
          document.getElementById('profile-licenses').textContent = currentUserStats.licenses;
          document.getElementById('profile-searches').textContent = currentUserStats.searches;
          document.getElementById('profile-rating').textContent = currentUserStats.rating;
          
          const regDate = new Date(currentUser.registration_date || currentUser.created_at);
          document.getElementById('profile-regdate').textContent = regDate.toLocaleDateString('ru-RU');
        }

        // Обновление статистики
        async function updateStat(stat, value) {
          if (!currentUser) {
            showError('Необходимо авторизоваться');
            return;
          }

          const success = await updateUserStats(currentUser.id, stat, value);
          if (success) {
            // Обновляем локальные данные
            currentUserStats[stat] = Math.max(0, currentUserStats[stat] + value);
            updateUserInterface();
            updateProfileInfo();
            
            logAdminAction('edit_stats', currentUser.id, `Изменение статистики: ${stat} на ${value}`);
          } else {
            showError('Ошибка при обновлении статистики');
          }
        }

        // Обновление таблицы лидеров
        async function updateLeaderboards() {
          const finesData = await getLeaderboard('fines');
          const arrestsData = await getLeaderboard('arrests');
          const licensesData = await getLeaderboard('licenses');
          const searchesData = await getLeaderboard('searches');

          // Заполняем таблицу штрафов
          const finesTable = document.getElementById('fines-leaderboard');
          finesTable.innerHTML = '';
          finesData.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>${item.users.nickname}</td>
              <td>${item.fines}</td>
              <td>${item.users.rank}</td>
              <td>${item.users.fraction}</td>
            `;
            finesTable.appendChild(row);
          });

          // Заполняем таблицу задержаний
          const arrestsTable = document.getElementById('arrests-leaderboard');
          arrestsTable.innerHTML = '';
          arrestsData.forEach((item, index) => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${index + 1}</td>
              <td>${item.users.nickname}</td>
              <td>${item.arrests}</td>
              <td>${item.users.rank}</td>
              <td>${item.users.fraction}</td>
            `;
            arrestsTable.appendChild(row);
          });

          // Аналогично для остальных таблиц...
        }

        // ==================== ОБРАБОТЧИКИ СОБЫТИЙ ====================

        document.addEventListener('DOMContentLoaded', async function() {
          // Инициализация темы
          applyTheme();
          
          // Проверяем авторизацию
          currentUser = await checkAuth();
          
          if (currentUser) {
            currentUserStats = await getUserStats(currentUser.id);
            updateUserInterface();
            hideAuthModal();
          } else {
            showAuthModal();
          }
          
          // Показываем главную страницу
          showSection('dashboard');
          
          // Загружаем всех пользователей для админ-панели
          allUsers = await getAllUsers();
        });

        // Переключение темы
        document.getElementById('themeToggle').addEventListener('click', function() {
          isDarkTheme = !isDarkTheme;
          localStorage.setItem('darkTheme', isDarkTheme);
          applyTheme();
        });

        // Обработка формы входа
        document.getElementById('loginForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const username = document.getElementById('loginUsername').value;
          const password = document.getElementById('loginPassword').value;
          
          const result = await loginUser(username, password);
          
          if (result.success) {
            currentUser = result.user;
            currentUserStats = await getUserStats(currentUser.id);
            updateUserInterface();
            hideAuthModal();
            alert('✅ Вход выполнен успешно!');
          } else {
            alert('❌ ' + result.error);
          }
        });

        // Обработка формы регистрации
        document.getElementById('registerForm').addEventListener('submit', async function(e) {
          e.preventDefault();
          
          const formData = {
            nickname: document.getElementById('registerNickname').value,
            username: document.getElementById('registerUsername').value,
            email: document.getElementById('registerEmail').value,
            password: document.getElementById('registerPassword').value
          };
          
          const confirmPassword = document.getElementById('registerConfirmPassword').value;
          
          if (formData.password !== confirmPassword) {
            alert('❌ Пароли не совпадают!');
            return;
          }
          
          const result = await registerUser(formData);
          
          if (result.success) {
            currentUser = result.user;
            currentUserStats = await getUserStats(currentUser.id);
            updateUserInterface();
            hideAuthModal();
            
            if (isSuperAdmin(currentUser)) {
              alert('🎉 Регистрация успешна! Вы стали Главным Администратором системы.');
            } else {
              alert('🎉 Регистрация успешна! Ваша роль: Гражданский');
            }
          } else {
            alert('❌ ' + result.error);
          }
        });

        // Функция для переключения между разделами
        function showSection(sectionName) {
          // Скрываем все разделы
          document.querySelectorAll('.content-section').forEach(section => {
            section.style.display = 'none';
          });
          
          // Показываем нужный раздел
          document.getElementById(sectionName + '-section').style.display = 'block';
          
          // Обновляем активную вкладку в навигации
          document.querySelectorAll('.nav-tabs a').forEach(link => {
            link.classList.remove('active');
          });
          
          // Находим и активируем соответствующую ссылку
          const activeLink = Array.from(document.querySelectorAll('.nav-tabs a')).find(link => 
            link.getAttribute('onclick')?.includes(sectionName)
          );
          if (activeLink) {
            activeLink.classList.add('active');
          }
          
          // Специальные действия для некоторых разделов
          if (sectionName === 'leaderboard') {
            updateLeaderboards();
          } else if (sectionName === 'profile') {
            updateProfileInfo();
          } else if (sectionName === 'admin' && hasPermission(currentUser, 'view_users')) {
            showAdminTab('users'); // Показываем первую вкладку по умолчанию
          } else if (sectionName === 'statistics' && currentUserStats) {
            document.getElementById('stat-fines').textContent = currentUserStats.fines;
            document.getElementById('stat-arrests').textContent = currentUserStats.arrests;
            document.getElementById('stat-licenses').textContent = currentUserStats.licenses;
            document.getElementById('stat-searches').textContent = currentUserStats.searches;
            document.getElementById('stat-rating').textContent = currentUserStats.rating;
          } else if (sectionName === 'settings') {
            loadSettings();
          }
        }

        // Функция для копирования биндов
        function copyBind(key) {
          const bindText = `bind ${key}`;
          navigator.clipboard.writeText(bindText)
            .then(() => alert(`Бинд "${bindText}" скопирован!`))
            .catch(err => console.error('Ошибка копирования: ', err));
        }

        function copyBindText(text) {
          navigator.clipboard.writeText(text)
            .then(() => alert('Бинд скопирован!'))
            .catch(err => console.error('Ошибка копирования: ', err));
        }

        // Переключение формы профиля
        function toggleProfileForm() {
          if (currentUser) {
            showSection('profile');
          } else {
            showAuthModal();
          }
        }

        // ==================== ДОПОЛНИТЕЛЬНЫЕ ФУНКЦИИ ДЛЯ АДМИН-ПАНЕЛИ ====================

        // Показать вкладку админ-панели
        function showAdminTab(tabName) {
            // Скрываем все вкладки
            document.querySelectorAll('.admin-tab-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Показываем нужную вкладку
            document.getElementById(`admin-${tabName}`).style.display = 'block';
            
            // Обновляем активные табы
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Загружаем данные для вкладки
            if (tabName === 'users') {
                loadUsersForAdmin();
            } else if (tabName === 'admins') {
                loadAdminsForAdmin();
            } else if (tabName === 'bans') {
                loadBansForAdmin();
            }
        }

        // Загрузка пользователей для админ-панели
        async function loadUsersForAdmin() {
            if (!requirePermission('view_users')) return;
            
            try {
                const users = await getAllUsers();
                
                // Заполняем выпадающие списки
                const editUserSelect = document.getElementById('editUser');
                const adminUserSelect = document.getElementById('adminUser');
                const banUserSelect = document.getElementById('banUser');
                
                editUserSelect.innerHTML = '';
                adminUserSelect.innerHTML = '';
                banUserSelect.innerHTML = '';
                
                users.forEach(user => {
                    if (user.id !== currentUser.id && !isSuperAdmin(user)) {
                        // Для редактирования
                        const option1 = document.createElement('option');
                        option1.value = user.id;
                        option1.textContent = `${user.nickname} (${user.role})`;
                        editUserSelect.appendChild(option1);
                        
                        // Для назначения админа (только обычные пользователи)
                        if (user.role === 'USER') {
                            const option2 = document.createElement('option');
                            option2.value = user.id;
                            option2.textContent = user.nickname;
                            adminUserSelect.appendChild(option2);
                        }
                        
                        // Для бана
                        const option3 = document.createElement('option');
                        option3.value = user.id;
                        option3.textContent = user.nickname;
                        banUserSelect.appendChild(option3);
                    }
                });
                
                // Заполняем таблицу пользователей
                const usersTable = document.getElementById('usersTable');
                usersTable.innerHTML = '';
                
                users.forEach(user => {
                    const row = document.createElement('tr');
                    
                    let roleBadge = '';
                    if (isSuperAdmin(user)) {
                        roleBadge = '<span style="color: gold;">Главный Админ</span>';
                    } else if (user.role === 'ADMIN') {
                        roleBadge = '<span style="color: var(--accent);">Админ</span>';
                    } else if (user.role === 'MODERATOR') {
                        roleBadge = '<span style="color: #f59e0b;">Модератор</span>';
                    } else if (user.role === 'HELPER') {
                        roleBadge = '<span style="color: #10b981;">Помощник</span>';
                    } else {
                        roleBadge = 'Гражданский';
                    }
                    
                    row.innerHTML = `
                        <td>${user.id}</td>
                        <td>${user.nickname}</td>
                        <td>${user.rank}</td>
                        <td>${user.position}</td>
                        <td>${user.fraction}</td>
                        <td>${user.city}</td>
                        <td>${user.banned ? '<span style="color: var(--danger);">Заблокирован</span>' : roleBadge}</td>
                        <td>
                            ${hasPermission(currentUser, 'manage_users') ? 
                              `<button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;" onclick="selectUserForEdit(${user.id})">Изменить</button>` : ''}
                            ${hasPermission(currentUser, 'assign_roles') && user.role === 'USER' ? 
                              `<button class="btn btn-warning" style="padding: 5px 10px; font-size: 0.8rem;" onclick="assignAdminPrompt(${user.id})">Сделать админом</button>` : ''}
                        </td>
                    `;
                    usersTable.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading users for admin:', error);
                showError('Ошибка загрузки пользователей');
            }
        }

        // Загрузка администраторов
        async function loadAdminsForAdmin() {
            if (!requirePermission('view_users')) return;
            
            try {
                const users = await getAllUsers();
                const admins = users.filter(user => 
                    user.role !== 'USER' && user.role !== 'HELPER' && !isSuperAdmin(user)
                );
                
                // Заполняем выпадающий список для снятия прав
                const removeAdminSelect = document.getElementById('removeAdminUser');
                removeAdminSelect.innerHTML = '';
                
                admins.forEach(admin => {
                    const option = document.createElement('option');
                    option.value = admin.id;
                    option.textContent = `${admin.nickname} (${admin.role})`;
                    removeAdminSelect.appendChild(option);
                });
                
                // Заполняем таблицу администраторов
                const adminsTable = document.getElementById('adminsTable');
                adminsTable.innerHTML = '';
                
                admins.forEach(admin => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${admin.id}</td>
                        <td>${admin.nickname}</td>
                        <td>${admin.rank}</td>
                        <td>${admin.position}</td>
                        <td>${admin.fraction}</td>
                        <td>${admin.city}</td>
                        <td>${admin.role === 'ADMIN' ? 'Администратор' : 'Модератор'}</td>
                        <td>
                            <button class="btn btn-danger" style="padding: 5px 10px; font-size: 0.8rem;" onclick="removeAdminPrompt(${admin.id})">Снять права</button>
                        </td>
                    `;
                    adminsTable.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading admins:', error);
                showError('Ошибка загрузки администраторов');
            }
        }

        // Загрузка банов
        async function loadBansForAdmin() {
            if (!requirePermission('view_logs')) return;
            
            try {
                const users = await getAllUsers();
                const bannedUsers = users.filter(user => user.banned);
                
                // Заполняем выпадающий список для разбана
                const unbanSelect = document.getElementById('unbanUser');
                unbanSelect.innerHTML = '';
                
                bannedUsers.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = user.nickname;
                    unbanSelect.appendChild(option);
                });
                
                // Заполняем таблицу банов
                const bansTable = document.getElementById('bansTable');
                bansTable.innerHTML = '';
                
                bannedUsers.forEach(user => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${user.id}</td>
                        <td>${user.nickname}</td>
                        <td>${user.ban_reason || 'Не указана'}</td>
                        <td>${user.ban_date ? new Date(user.ban_date).toLocaleDateString('ru-RU') : 'Неизвестно'}</td>
                        <td>${user.ban_expires ? new Date(user.ban_expires).toLocaleDateString('ru-RU') : 'Перманентно'}</td>
                        <td>${user.banned_by || 'Система'}</td>
                        <td>
                            <button class="btn btn-success" style="padding: 5px 10px; font-size: 0.8rem;" onclick="unbanUserPrompt(${user.id})">Разблокировать</button>
                        </td>
                    `;
                    bansTable.appendChild(row);
                });
                
            } catch (error) {
                console.error('Error loading bans:', error);
                showError('Ошибка загрузки списка банов');
            }
        }

        // ==================== ФУНКЦИИ ДЛЯ ТАБЛИЦЫ ЛИДЕРОВ ====================

        // Показать определенную таблицу лидеров
        function showLeaderboard(type) {
            // Скрываем все таблицы
            document.querySelectorAll('.leaderboard-content').forEach(content => {
                content.style.display = 'none';
            });
            
            // Показываем нужную таблицу
            document.getElementById(`leaderboard-${type}`).style.display = 'block';
            
            // Обновляем активные табы
            document.querySelectorAll('.leaderboard-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Обновляем данные для этой таблицы
            updateLeaderboardTable(type);
        }

        // Обновление конкретной таблицы лидеров
        async function updateLeaderboardTable(type) {
            try {
                const data = await getLeaderboard(type);
                const tableId = `${type}-leaderboard`;
                const table = document.getElementById(tableId);
                
                if (!table) return;
                
                table.innerHTML = '';
                
                data.forEach((item, index) => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${item.users.nickname}</td>
                        <td>${item[type]}</td>
                        <td>${item.users.rank}</td>
                        <td>${item.users.fraction}</td>
                    `;
                    table.appendChild(row);
                });
                
            } catch (error) {
                console.error(`Error updating ${type} leaderboard:`, error);
            }
        }

        // ==================== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ АДМИН-ПАНЕЛИ ====================

        // Подсказка для редактирования пользователя
        function selectUserForEdit(userId) {
            document.getElementById('editUser').value = userId;
            
            // Находим пользователя и заполняем форму его данными
            const user = allUsers.find(u => u.id === userId);
            if (user) {
                document.getElementById('editFraction').value = user.fraction || '';
                document.getElementById('editCity').value = user.city || 'Приволжск';
                document.getElementById('editRank').value = user.rank || 'Гражданский';
                document.getElementById('editPosition').value = user.position || '';
            }
        }

        // Подсказка для назначения админа
        function assignAdminPrompt(userId) {
            document.getElementById('adminUser').value = userId;
        }

        // Подсказка для снятия прав админа
        function removeAdminPrompt(userId) {
            document.getElementById('removeAdminUser').value = userId;
        }

        // Подсказка для разбана
        function unbanUserPrompt(userId) {
            document.getElementById('unbanUser').value = userId;
        }

        // Назначение администратора
        async function assignAdmin() {
            if (!requirePermission('assign_roles')) return;
            
            const userId = parseInt(document.getElementById('adminUser').value);
            
            if (!userId) {
                showError('Выберите пользователя');
                return;
            }
            
            try {
                const success = await updateUserInDatabase(userId, {
                    role: 'ADMIN'
                });
                
                if (success) {
                    alert('✅ Пользователь назначен администратором!');
                    loadUsersForAdmin();
                    loadAdminsForAdmin();
                    logAdminAction('assign_admin', userId, 'Назначение администратором');
                } else {
                    showError('Ошибка при назначении администратора');
                }
            } catch (error) {
                console.error('Error assigning admin:', error);
                showError('Ошибка при назначении администратора');
            }
        }

        // Снятие прав администратора
        async function removeAdmin() {
            if (!requirePermission('assign_roles')) return;
            
            const userId = parseInt(document.getElementById('removeAdminUser').value);
            
            if (!userId) {
                showError('Выберите администратора');
                return;
            }
            
            try {
                const success = await updateUserInDatabase(userId, {
                    role: 'USER'
                });
                
                if (success) {
                    alert('✅ Права администратора сняты!');
                    loadUsersForAdmin();
                    loadAdminsForAdmin();
                    logAdminAction('remove_admin', userId, 'Снятие прав администратора');
                } else {
                    showError('Ошибка при снятии прав');
                }
            } catch (error) {
                console.error('Error removing admin:', error);
                showError('Ошибка при снятии прав');
            }
        }

        // Блокировка пользователя
        async function banUser() {
            if (!requirePermission('ban_users')) return;
            
            const userId = parseInt(document.getElementById('banUser').value);
            const reason = document.getElementById('banReason').value;
            const duration = parseInt(document.getElementById('banDuration').value) || 0;
            
            if (!userId) {
                showError('Выберите пользователя');
                return;
            }
            
            if (!reason) {
                showError('Введите причину блокировки');
                return;
            }
            
            try {
                const success = await banUserInDatabase(userId, reason, duration, currentUser.nickname);
                
                if (success) {
                    alert('✅ Пользователь заблокирован!');
                    document.getElementById('banReason').value = '';
                    document.getElementById('banDuration').value = '';
                    loadUsersForAdmin();
                    loadBansForAdmin();
                    logAdminAction('ban_user', userId, `Блокировка. Причина: ${reason}, срок: ${duration} дней`);
                } else {
                    showError('Ошибка при блокировке пользователя');
                }
            } catch (error) {
                console.error('Error banning user:', error);
                showError('Ошибка при блокировке пользователя');
            }
        }

        // Разблокировка пользователя
        async function unbanUser() {
            if (!requirePermission('ban_users')) return;
            
            const userId = parseInt(document.getElementById('unbanUser').value);
            
            if (!userId) {
                showError('Выберите пользователя');
                return;
            }
            
            try {
                const success = await unbanUserInDatabase(userId);
                
                if (success) {
                    alert('✅ Пользователь разблокирован!');
                    loadUsersForAdmin();
                    loadBansForAdmin();
                    logAdminAction('unban_user', userId, 'Разблокировка пользователя');
                } else {
                    showError('Ошибка при разблокировке пользователя');
                }
            } catch (error) {
                console.error('Error unbanning user:', error);
                showError('Ошибка при разблокировке пользователя');
            }
        }

        // ==================== НОВЫЕ ФУНКЦИИ ДЛЯ СИСТЕМЫ НАСТРОЕК ====================

        // Показать раздел настроек
        function showSettingsSection() {
            showSection('settings');
            loadSettings();
        }

        // Загрузка настроек пользователя
        async function loadSettings() {
            if (!currentUser) return;

            try {
                // Загружаем настройки из базы данных
                const { data: settings, error } = await supabase
                    .from('user_settings')
                    .select('*')
                    .eq('user_id', currentUser.id)
                    .single();

                if (error && error.code !== 'PGRST116') {
                    console.error('Error loading settings:', error);
                    return;
                }

                // Применяем настройки
                if (settings) {
                    // Тема
                    if (settings.theme === 'dark') {
                        setTheme(true);
                    } else {
                        setTheme(false);
                    }

                    // Размер шрифта
                    if (settings.font_size) {
                        document.getElementById('fontSize').value = settings.font_size;
                        updateFontSize(settings.font_size);
                    }

                    // Компактный режим
                    if (settings.compact_mode) {
                        document.getElementById('compactMode').checked = true;
                        toggleCompactMode(true);
                    }

                    // Уведомления
                    if (settings.notifications) {
                        const notifSettings = settings.notifications;
                        document.getElementById('emailNotifications').checked = notifSettings.email || false;
                        document.getElementById('systemUpdates').checked = notifSettings.system_updates || false;
                        document.getElementById('weeklyReports').checked = notifSettings.weekly_reports || false;
                    }
                }

                // Показываем административные настройки если пользователь админ
                if (hasPermission(currentUser, 'manage_users')) {
                    document.getElementById('adminSettings').style.display = 'block';
                }

            } catch (error) {
                console.error('Error loading user settings:', error);
            }
        }

        // Сохранение настроек
        async function saveSettings(settings) {
            if (!currentUser) return false;

            try {
                const { error } = await supabase
                    .from('user_settings')
                    .upsert({
                        user_id: currentUser.id,
                        ...settings,
                        updated_at: new Date().toISOString()
                    });

                return !error;
            } catch (error) {
                console.error('Error saving settings:', error);
                return false;
            }
        }

        // ==================== СИСТЕМА СМЕНЫ ПАРОЛЯ ====================

        // Показать модальное окно смены пароля
        function showChangePasswordModal() {
            if (!currentUser) {
                showError('Необходимо авторизоваться');
                return;
            }
            document.getElementById('changePasswordForm').reset();
            showModal('changePasswordModal');
        }

        // Обработка смены пароля
        document.getElementById('changePasswordForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmNewPassword').value;

            // Проверка совпадения паролей
            if (newPassword !== confirmPassword) {
                showError('Новые пароли не совпадают');
                return;
            }

            // Проверка длины пароля
            if (newPassword.length < 6) {
                showError('Пароль должен содержать минимум 6 символов');
                return;
            }

            try {
                // Проверяем текущий пароль
                const isCurrentPasswordValid = await hashPassword(currentPassword) === currentUser.password_hash;
                if (!isCurrentPasswordValid) {
                    showError('Текущий пароль неверен');
                    return;
                }

                // Обновляем пароль в базе данных
                const { error } = await supabase
                    .from('users')
                    .update({
                        password_hash: await hashPassword(newPassword),
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', currentUser.id);

                if (error) throw error;

                // Обновляем локальные данные пользователя
                currentUser.password_hash = await hashPassword(newPassword);
                localStorage.setItem('currentUser', JSON.stringify(currentUser));

                alert('✅ Пароль успешно изменен!');
                hideModal('changePasswordModal');
                logAdminAction('change_password', currentUser.id, 'Смена пароля');

            } catch (error) {
                console.error('Error changing password:', error);
                showError('Ошибка при смене пароля');
            }
        });

        // ==================== СИСТЕМА СМЕНЫ НИКНЕЙМА ====================

        // Показать модальное окно смены никнейма
        function showChangeNicknameModal(forOtherUser = false) {
            if (!currentUser) {
                showError('Необходимо авторизоваться');
                return;
            }

            document.getElementById('changeNicknameForm').reset();
            const targetSection = document.getElementById('nicknameTarget');
            
            if (forOtherUser && hasPermission(currentUser, 'manage_users')) {
                targetSection.style.display = 'block';
                loadUsersForNicknameChange();
            } else {
                targetSection.style.display = 'none';
                document.getElementById('newNickname').value = currentUser.nickname;
            }

            showModal('changeNicknameModal');
        }

        // Загрузка пользователей для смены никнейма
        async function loadUsersForNicknameChange() {
            if (!hasPermission(currentUser, 'manage_users')) return;

            try {
                const users = await getAllUsers();
                const select = document.getElementById('targetUser');
                select.innerHTML = '';

                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = `${user.nickname} (${user.role})`;
                    select.appendChild(option);
                });

            } catch (error) {
                console.error('Error loading users for nickname change:', error);
            }
        }

        // Обработка смены никнейма
        document.getElementById('changeNicknameForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const newNickname = document.getElementById('newNickname').value.trim();
            const targetUserSelect = document.getElementById('targetUser');
            let targetUserId = currentUser.id;

            // Если меняем ник другому пользователю
            if (targetUserSelect.style.display !== 'none' && targetUserSelect.value) {
                if (!hasPermission(currentUser, 'manage_users')) {
                    showError('Недостаточно прав');
                    return;
                }
                targetUserId = parseInt(targetUserSelect.value);
            }

            if (!newNickname) {
                showError('Введите новый никнейм');
                return;
            }

            try {
                // Проверяем, не занят ли никнейм
                const { data: existingUser, error: checkError } = await supabase
                    .from('users')
                    .select('id')
                    .eq('nickname', newNickname)
                    .neq('id', targetUserId)
                    .single();

                if (existingUser) {
                    showError('Этот никнейм уже занят');
                    return;
                }

                // Обновляем никнейм в базе данных
                const { error } = await supabase
                    .from('users')
                    .update({
                        nickname: newNickname,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', targetUserId);

                if (error) throw error;

                // Обновляем локальные данные если меняем свой ник
                if (targetUserId === currentUser.id) {
                    currentUser.nickname = newNickname;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    updateUserInterface();
                }

                alert('✅ Никнейм успешно изменен!');
                hideModal('changeNicknameModal');
                
                const actionText = targetUserId === currentUser.id ? 
                    'Смена собственного никнейма' : 
                    `Смена никнейма пользователю ID: ${targetUserId}`;
                
                logAdminAction('change_nickname', targetUserId, actionText);

            } catch (error) {
                console.error('Error changing nickname:', error);
                showError('Ошибка при смене никнейма');
            }
        });

        // ==================== СИСТЕМА ВЫБОРА ЗВАНИЙ И ДОЛЖНОСТЕЙ ====================

        // Показать модальное окно выбора звания и должности
        function showRankPositionModal(forOtherUser = false) {
            if (!currentUser) {
                showError('Необходимо авторизоваться');
                return;
            }

            document.getElementById('rankPositionForm').reset();
            const targetSection = document.getElementById('rankPositionTarget');
            
            if (forOtherUser && hasPermission(currentUser, 'manage_users')) {
                targetSection.style.display = 'block';
                loadUsersForRankChange();
            } else {
                targetSection.style.display = 'none';
                // Устанавливаем текущие значения
                if (currentUser.rank) {
                    selectRank(currentUser.rank);
                }
                document.getElementById('positionInput').value = currentUser.position || '';
            }

            showModal('rankPositionModal');
        }

        // Загрузка пользователей для изменения званий
        async function loadUsersForRankChange() {
            if (!hasPermission(currentUser, 'manage_users')) return;

            try {
                const users = await getAllUsers();
                const select = document.getElementById('targetUserRank');
                select.innerHTML = '';

                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = `${user.nickname} (${user.rank || 'Без звания'})`;
                    select.appendChild(option);
                });

            } catch (error) {
                console.error('Error loading users for rank change:', error);
            }
        }

        // Выбор звания
        function selectRank(rank) {
            // Снимаем выделение со всех вариантов
            document.querySelectorAll('.rank-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            // Выделяем выбранный вариант
            const selectedOption = document.querySelector(`.rank-option[data-rank="${rank}"]`);
            if (selectedOption) {
                selectedOption.classList.add('selected');
                document.getElementById('selectedRank').value = rank;
            }
        }

        // Обработка выбора звания и должности
        document.getElementById('rankPositionForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            const selectedRank = document.getElementById('selectedRank').value;
            const position = document.getElementById('positionInput').value.trim();
            const targetUserSelect = document.getElementById('targetUserRank');
            let targetUserId = currentUser.id;

            // Если назначаем другому пользователю
            if (targetUserSelect.style.display !== 'none' && targetUserSelect.value) {
                if (!hasPermission(currentUser, 'manage_users')) {
                    showError('Недостаточно прав');
                    return;
                }
                targetUserId = parseInt(targetUserSelect.value);
            }

            if (!selectedRank) {
                showError('Выберите звание');
                return;
            }

            if (!position) {
                showError('Введите должность');
                return;
            }

            try {
                // Обновляем данные в базе
                const { error } = await supabase
                    .from('users')
                    .update({
                        rank: selectedRank,
                        position: position,
                        updated_at: new Date().toISOString()
                    })
                    .eq('id', targetUserId);

                if (error) throw error;

                // Обновляем локальные данные если меняем свои данные
                if (targetUserId === currentUser.id) {
                    currentUser.rank = selectedRank;
                    currentUser.position = position;
                    localStorage.setItem('currentUser', JSON.stringify(currentUser));
                    updateUserInterface();
                }

                alert('✅ Звание и должность успешно обновлены!');
                hideModal('rankPositionModal');
                
                const actionText = targetUserId === currentUser.id ? 
                    'Изменение собственного звания/должности' : 
                    `Назначение звания/должности пользователю ID: ${targetUserId}`;
                
                logAdminAction('change_rank_position', targetUserId, actionText);

            } catch (error) {
                console.error('Error updating rank/position:', error);
                showError('Ошибка при обновлении звания и должности');
            }
        });

        // ==================== СИСТЕМА РЕДАКТИРОВАНИЯ СТАТИСТИКИ ====================

        // Показать модальное окно редактирования статистики
        async function showEditStatsModal() {
            if (!hasPermission(currentUser, 'edit_stats') || !isSuperAdmin(currentUser)) {
                showError('Недостаточно прав');
                return;
            }

            try {
                const users = await getAllUsers();
                const select = document.getElementById('statsUser');
                select.innerHTML = '';

                users.forEach(user => {
                    const option = document.createElement('option');
                    option.value = user.id;
                    option.textContent = `${user.nickname} (${user.rank || 'Без звания'})`;
                    select.appendChild(option);
                });

                // Загружаем статистику первого пользователя по умолчанию
                if (users.length > 0) {
                    await loadUserStats(users[0].id);
                }

                showModal('editStatsModal');

            } catch (error) {
                console.error('Error loading users for stats edit:', error);
                showError('Ошибка загрузки пользователей');
            }
        }

        // Загрузка статистики пользователя
        async function loadUserStats(userId) {
            try {
                const stats = await getUserStats(userId);
                if (stats) {
                    document.getElementById('editFines').value = stats.fines || 0;
                    document.getElementById('editArrests').value = stats.arrests || 0;
                    document.getElementById('editLicenses').value = stats.licenses || 0;
                    document.getElementById('editSearches').value = stats.searches || 0;
                    document.getElementById('editRating').value = stats.rating || 0;
                }
            } catch (error) {
                console.error('Error loading user stats:', error);
            }
        }

        // Обработка изменения выбора пользователя
        document.getElementById('statsUser').addEventListener('change', function() {
            const userId = parseInt(this.value);
            if (userId) {
                loadUserStats(userId);
            }
        });

        // Обработка сохранения статистики
        document.getElementById('editStatsForm').addEventListener('submit', async function(e) {
            e.preventDefault();

            if (!hasPermission(currentUser, 'edit_stats') || !isSuperAdmin(currentUser)) {
                showError('Недостаточно прав');
                return;
            }

            const userId = parseInt(document.getElementById('statsUser').value);
            const fines = parseInt(document.getElementById('editFines').value);
            const arrests = parseInt(document.getElementById('editArrests').value);
            const licenses = parseInt(document.getElementById('editLicenses').value);
            const searches = parseInt(document.getElementById('editSearches').value);
            const rating = parseInt(document.getElementById('editRating').value);

            if (!userId) {
                showError('Выберите пользователя');
                return;
            }

            try {
                // Обновляем статистику в базе данных
                const { error } = await supabase
                    .from('user_stats')
                    .update({
                        fines: fines,
                        arrests: arrests,
                        licenses: licenses,
                        searches: searches,
                        rating: rating,
                        updated_at: new Date().toISOString()
                    })
                    .eq('user_id', userId);

                if (error) throw error;

                alert('✅ Статистика успешно обновлена!');
                hideModal('editStatsModal');
                
                logAdminAction('edit_user_stats', userId, 
                    `Обновление статистики: штрафы=${fines}, задержания=${arrests}, права=${licenses}, досмотры=${searches}, рейтинг=${rating}`);

            } catch (error) {
                console.error('Error updating stats:', error);
                showError('Ошибка при обновлении статистики');
            }
        });

        // ==================== ФУНКЦИИ КАСТОМИЗАЦИИ ====================

        // Установка темы
        function setTheme(isDark) {
            isDarkTheme = isDark;
            localStorage.setItem('darkTheme', isDark);
            applyTheme();
            
            // Обновляем кнопки
            document.getElementById('lightThemeBtn').classList.toggle('selected', !isDark);
            document.getElementById('darkThemeBtn').classList.toggle('selected', isDark);
            
            // Сохраняем в настройках
            saveSettings({ theme: isDark ? 'dark' : 'light' });
        }

        // Обновление размера шрифта
        function updateFontSize(size) {
            document.body.style.fontSize = size === 'small' ? '14px' : size === 'large' ? '18px' : '16px';
            saveSettings({ font_size: size });
        }

        // Переключение компактного режима
        function toggleCompactMode(compact) {
            if (compact) {
                document.body.classList.add('compact-mode');
            } else {
                document.body.classList.remove('compact-mode');
            }
            saveSettings({ compact_mode: compact });
        }

        // Обновление настроек уведомлений
        function updateNotificationSettings() {
            const settings = {
                email: document.getElementById('emailNotifications').checked,
                system_updates: document.getElementById('systemUpdates').checked,
                weekly_reports: document.getElementById('weeklyReports').checked
            };
            saveSettings({ notifications: settings });
        }

        // ==================== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ====================

        // Показать модальное окно
        function showModal(modalId) {
            document.getElementById(modalId).style.display = 'flex';
        }

        // Скрыть модальное окно
        function hideModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }

        // ==================== ФИКС КЭША CLOUDFLARE ====================

        // Принудительное обновление кэша при каждой загрузке
        const CACHE_BUSTER = 'v=' + Date.now();

        // Добавляем параметр версии ко всем запросам
        function bustCache() {
            const links = document.querySelectorAll('link[rel="stylesheet"]');
            const scripts = document.querySelectorAll('script[src]');
            
            links.forEach(link => {
                const href = link.getAttribute('href');
                if (href && !href.includes('?')) {
                    link.setAttribute('href', href + '?' + CACHE_BUSTER);
                }
            });
            
            console.log('🔄 Cache buster activated:', CACHE_BUSTER);
        }

        // Вызываем при загрузке
        bustCache();

        // ==================== ЗАГРУЗКА ПОЛЬЗОВАТЕЛЕЙ В АДМИН-ПАНЕЛЬ ====================

        // Основная функция загрузки пользователей для админ-панели
        window.loadUsersForAdmin = async function() {
            console.log('🔄 Загрузка пользователей для админки');
            
            try {
                // Получаем всех пользователей из базы
                const { data: users, error } = await supabase
                    .from('users')
                    .select('*')
                    .order('created_at', { ascending: false });

                if (error) {
                    console.error('❌ Ошибка загрузки пользователей:', error);
                    return;
                }

                console.log('✅ Пользователи загружены:', users);
                allUsers = users; // Сохраняем пользователей в глобальную переменную

                // Заполняем выпадающий список для редактирования
                const editUserSelect = document.getElementById('editUser');
                const adminUserSelect = document.getElementById('adminUser');
                const banUserSelect = document.getElementById('banUser');
                const removeAdminSelect = document.getElementById('removeAdminUser');
                const unbanSelect = document.getElementById('unbanUser');

                // Очищаем списки
                editUserSelect.innerHTML = '<option value="">Выберите пользователя</option>';
                adminUserSelect.innerHTML = '<option value="">Выберите пользователя</option>';
                banUserSelect.innerHTML = '<option value="">Выберите пользователя</option>';
                removeAdminSelect.innerHTML = '<option value="">Выберите администратора</option>';
                unbanSelect.innerHTML = '<option value="">Выберите пользователя</option>';

                // Заполняем списки
                users.forEach(user => {
                    if (user.id === currentUser.id) return; // Пропускаем текущего пользователя

                    const optionText = `${user.nickname} (${user.role})`;

                    // Для редактирования - все пользователи
                    const editOption = document.createElement('option');
                    editOption.value = user.id;
                    editOption.textContent = optionText;
                    editUserSelect.appendChild(editOption);

                    // Для назначения админа - только обычные пользователи
                    if (user.role === 'USER') {
                        const adminOption = document.createElement('option');
                        adminOption.value = user.id;
                        adminOption.textContent = user.nickname;
                        adminUserSelect.appendChild(adminOption);
                    }

                    // Для бана - все пользователи кроме суперадминов
                    if (!isSuperAdmin(user)) {
                        const banOption = document.createElement('option');
                        banOption.value = user.id;
                        banOption.textContent = user.nickname + (user.banned ? ' ⛔' : '');
                        banUserSelect.appendChild(banOption);
                    }

                    // Для снятия прав - только админы и модераторы
                    if (user.role === 'ADMIN' || user.role === 'MODERATOR') {
                        const removeAdminOption = document.createElement('option');
                        removeAdminOption.value = user.id;
                        removeAdminOption.textContent = user.nickname;
                        removeAdminSelect.appendChild(removeAdminOption);
                    }

                    // Для разбана - только заблокированные
                    if (user.banned) {
                        const unbanOption = document.createElement('option');
                        unbanOption.value = user.id;
                        unbanOption.textContent = user.nickname;
                        unbanSelect.appendChild(unbanOption);
                    }
                });

                // Заполняем таблицу пользователей
                const usersTable = document.getElementById('usersTable');
                if (usersTable) {
                    usersTable.innerHTML = '';
                    
                    users.forEach(user => {
                        const row = document.createElement('tr');
                        
                        let roleBadge = '';
                        if (isSuperAdmin(user)) {
                            roleBadge = '<span style="color: gold;">Главный Админ</span>';
                        } else if (user.role === 'ADMIN') {
                            roleBadge = '<span style="color: var(--accent);">Админ</span>';
                        } else if (user.role === 'MODERATOR') {
                            roleBadge = '<span style="color: #f59e0b;">Модератор</span>';
                        } else if (user.role === 'HELPER') {
                            roleBadge = '<span style="color: #10b981;">Помощник</span>';
                        } else {
                            roleBadge = 'Гражданский';
                        }

                        row.innerHTML = `
                            <td>${user.id}</td>
                            <td>${user.nickname}</td>
                            <td>${user.rank}</td>
                            <td>${user.position}</td>
                            <td>${user.fraction}</td>
                            <td>${user.city}</td>
                            <td>${user.banned ? '<span style="color: var(--danger);">⛔ Заблокирован</span>' : roleBadge}</td>
                            <td>
                                <button class="btn btn-outline" style="padding: 5px 10px; font-size: 0.8rem;" onclick="selectUserForEdit(${user.id})">Изменить</button>
                            </td>
                        `;
                        usersTable.appendChild(row);
                    });
                }

            } catch (error) {
                console.error('❌ Ошибка загрузки пользователей:', error);
            }
        };

        // Функция для выбора пользователя в форме редактирования
        window.selectUserForEdit = function(userId) {
            document.getElementById('editUser').value = userId;
            
            // Находим пользователя и заполняем форму его данными
            const user = allUsers.find(u => u.id === userId);
            if (user) {
                document.getElementById('editFraction').value = user.fraction || '';
                document.getElementById('editCity').value = user.city || 'Приволжск';
                document.getElementById('editRank').value = user.rank || 'Гражданский';
                document.getElementById('editPosition').value = user.position || '';
            }
        };

        // Загружаем пользователей при открытии админ-панели
        document.addEventListener('DOMContentLoaded', function() {
            // Ждем немного перед загрузкой пользователей
            setTimeout(() => {
                if (currentUser && hasPermission(currentUser, 'view_users')) {
                    loadUsersForAdmin();
                }
            }, 1000);
        });

        // Также обновляем функцию showAdminTab чтобы загружать данные при переходе
        const originalShowAdminTab = window.showAdminTab;
        window.showAdminTab = function(tabName) {
            // Вызываем оригинальную функцию
            if (originalShowAdminTab) {
                originalShowAdminTab(tabName);
            }
            
            // Загружаем данные для вкладки
            if (tabName === 'users') {
                loadUsersForAdmin();
            }
        };

        console.log('🎯 Все системы загружены и готовы к работе!');
        // ==================== СИСТЕМА 2FA ====================

// Умная функция для 2FA
function enableTwoFactorAuth() {
  if (!currentUser) {
    showError('Необходимо авторизоваться');
    return;
  }
  
  // Генерируем секретный ключ
  const secret = generate2FASecret();
  
  // Показываем модальное окно с QR-кодом
  show2FAModal(secret);
}

// Генерация секретного ключа для 2FA
function generate2FASecret() {
  const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ234567';
  let secret = '';
  for (let i = 0; i < 16; i++) {
    secret += chars.charAt(Math.floor(Math.random() * chars.length));
  }
  return secret;
}

// Показ модального окна 2FA с QR-кодом
function show2FAModal(secret) {
  localStorage.setItem('temp2FASecret', secret);
  document.getElementById('secretKey').value = secret;
  generateQRCode(secret);
  showModal('twoFactorAuthModal');
}

// Генерация QR-кода
function generateQRCode(secret) {
  const qrContainer = document.getElementById('qrcode-container');
  const issuer = 'ГИБДД Провинция';
  const account = currentUser.email || currentUser.username;
  
  const otpauthUrl = `otpauth://totp/${encodeURIComponent(issuer)}:${encodeURIComponent(account)}?secret=${secret}&issuer=${encodeURIComponent(issuer)}&algorithm=SHA1&digits=6&period=30`;
  
  // Используем QRServer API вместо Google Charts
  const qrCodeUrl = `https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${encodeURIComponent(otpauthUrl)}`;
  
  qrContainer.innerHTML = `
    <div style="text-align: center;">
      <img src="${qrCodeUrl}" 
           alt="QR Code для 2FA" 
           style="border: 1px solid #ddd; padding: 10px; border-radius: 8px; background: white;"
           onerror="this.src='https://via.placeholder.com/200x200/ffffff/000000?text=QR+Error'">
      <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
        Отсканируйте QR-код в приложении Google Authenticator
      </p>
    </div>
  `;
}

// Включение 2FA после подтверждения
function enable2FA() {
  const code = document.getElementById('verificationCode').value;
  const secret = localStorage.getItem('temp2FASecret');
  
  if (!code || code.length !== 6) {
    showError('Введите 6-значный код из приложения');
    return;
  }
  
  if (!/^\d+$/.test(code)) {
    showError('Код должен содержать только цифры');
    return;
  }
  
  // Демо-реализация
  save2FASettings(secret)
    .then(() => {
      alert('✅ Двухфакторная аутентификация успешно включена!');
      hideModal('twoFactorAuthModal');
      localStorage.removeItem('temp2FASecret');
      document.getElementById('verificationCode').value = '';
      update2FAButton(true);
    })
    .catch(error => {
      showError('Ошибка сохранения настроек 2FA');
    });
}

// Сохранение настроек 2FA в базу (демо)
async function save2FASettings(secret) {
  console.log('Сохранение 2FA настроек:', { secret });
  return new Promise((resolve) => {
    setTimeout(() => resolve(), 1000);
  });
}

// Обновление кнопки 2FA
function update2FAButton(isEnabled) {
  const twoFactorBtn = document.querySelector('[onclick="enableTwoFactorAuth()"]');
  if (twoFactorBtn) {
    if (isEnabled) {
      twoFactorBtn.innerHTML = '<i class="fas fa-mobile-alt"></i> Отключить 2FA';
      twoFactorBtn.classList.remove('btn-outline');
      twoFactorBtn.classList.add('btn-warning');
    } else {
      twoFactorBtn.innerHTML = '<i class="fas fa-mobile-alt"></i> Включить 2FA';
      twoFactorBtn.classList.remove('btn-warning');
      twoFactorBtn.classList.add('btn-outline');
    }
  }
}

// Копирование секретного ключа
function copySecretKey() {
  const secretKeyInput = document.getElementById('secretKey');
  if (secretKeyInput && secretKeyInput.value) {
    secretKeyInput.select();
    document.execCommand('copy');
    alert('Секретный ключ скопирован в буфер обмена!');
  }
}

// ==================== ВСПОМОГАТЕЛЬНЫЕ ФУНКЦИИ ====================

function showModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'flex';
}

function hideModal(modalId) {
  const modal = document.getElementById(modalId);
  if (modal) modal.style.display = 'none';
}

function showError(message) {
  alert('❌ ' + message);
}

function showDeleteAccountModal() {
  if (!currentUser) {
    showError('Необходимо авторизоваться');
    return;
  }
  showModal('deleteAccountModal');
}

function deleteAccount() {
  const password = document.getElementById('confirmPassword')?.value;
  const confirmText = document.getElementById('confirmText')?.value;
  
  if (!password) {
    showError('Введите пароль');
    return;
  }
  
  if (confirmText !== 'УДАЛИТЬ АККАУНТ') {
    showError('Текст подтверждения неверен');
    return;
  }
  
  if (confirm('Вы уверены? Это действие необратимо!')) {
    alert('Аккаунт будет удален после реализации бэкенда');
    hideModal('deleteAccountModal');
  }
}
// Простая функция удаления аккаунта
function showDeleteAccountModal() {
  if (!currentUser) {
    showError('Необходимо авторизоваться');
    return;
  }
  showModal('deleteAccountModal');
}

// Заглушки для демонстрации
function enable2FA() {
  alert('2FA будет включено после реализации бэкенда');
  hideModal('twoFactorAuthModal');
}

function deleteAccount() {
  const password = document.getElementById('confirmPassword').value;
  const confirmText = document.getElementById('confirmText').value;
  
  if (!password) {
    showError('Введите пароль');
    return;
  }
  
  if (confirmText !== 'УДАЛИТЬ АККАУНТ') {
    showError('Текст подтверждения неверен');
    return;
  }
  
  if (confirm('Вы уверены? Это действие необратимо!')) {
    alert('Аккаунт будет удален после реализации бэкенда');
    hideModal('deleteAccountModal');
  }
}
// Отключение 2FA
async function disable2FA() {
  try {
    const { error } = await supabase
      .from('users')
      .update({
        two_factor_secret: null,
        two_factor_enabled: false,
        updated_at: new Date().toISOString()
      })
      .eq('id', currentUser.id);

    if (error) throw error;
    
    // Обновляем локальные данные
    currentUser.two_factor_secret = null;
    currentUser.two_factor_enabled = false;
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    
    alert('✅ Двухфакторная аутентификация отключена!');
    update2FAButton(false);
    
  } catch (error) {
    console.error('Error disabling 2FA:', error);
    showError('Ошибка отключения 2FA');
  }
}
    </script>
    <!-- Модальное окно 2FA -->
<div id="twoFactorAuthModal" class="modal" style="display: none;">
  <div class="modal-content modal-medium">
    <div class="modal-header">
      <h2><i class="fas fa-mobile-alt"></i> Двухфакторная аутентификация</h2>
    </div>
    <div class="modal-body">
      <div id="twoFactorSetup">
        <p>Для настройки 2FA выполните следующие шаги:</p>
        <ol>
          <li>Установите приложение <strong>Google Authenticator</strong> или <strong>Authy</strong></li>
          <li>Отсканируйте QR-код ниже или введите ключ вручную</li>
          <li>Введите 6-значный код из приложения для подтверждения</li>
        </ol>
        
        <div id="qrcode-container" style="text-align: center; margin: 20px 0; padding: 15px; background: var(--light); border-radius: 8px;">
          <!-- QR-код появится здесь -->
        </div>
        
        <div class="form-group">
          <label for="secretKey"><i class="fas fa-key"></i> Секретный ключ (для ручного ввода):</label>
          <div style="display: flex; gap: 10px; align-items: center;">
            <input type="text" id="secretKey" class="form-control" readonly 
                   style="font-family: monospace; letter-spacing: 1px;">
            <button type="button" class="btn btn-outline" onclick="copySecretKey()" 
                    style="white-space: nowrap;">
              <i class="fas fa-copy"></i>
            </button>
          </div>
          <small style="color: var(--gray); font-size: 0.8rem;">
            Сохраните этот ключ в надежном месте на случай потери доступа к приложению
          </small>
        </div>
        
        <div class="form-group">
          <label for="verificationCode"><i class="fas fa-shield-alt"></i> Код подтверждения:</label>
          <input type="text" id="verificationCode" class="form-control" 
                 placeholder="Введите 6-значный код из приложения" 
                 maxlength="6" pattern="[0-9]{6}" inputmode="numeric">
        </div>
        
        <div class="form-group" style="display: flex; gap: 10px;">
          <button class="btn btn-success" onclick="enable2FA()" style="flex: 1;">
            <i class="fas fa-check"></i> Включить 2FA
          </button>
          <button class="btn btn-outline" onclick="hideModal('twoFactorAuthModal')" style="flex: 1;">
            <i class="fas fa-times"></i> Отмена
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Модальное окно удаления аккаунта -->
<div id="deleteAccountModal" class="modal" style="display: none;">
  <div class="modal-content modal-medium">
    <div class="modal-header" style="background: var(--danger);">
      <h2><i class="fas fa-exclamation-triangle"></i> Удаление аккаунта</h2>
    </div>
    <div class="modal-body">
      <div class="danger-zone">
        <h4><i class="fas fa-exclamation-triangle"></i> Внимание! Это действие необратимо</h4>
        <p>Все ваши данные будут удалены без возможности восстановления.</p>
        
        <div class="form-group">
          <label for="confirmPassword">Введите ваш пароль:</label>
          <input type="password" id="confirmPassword" class="form-control" placeholder="Введите ваш пароль">
        </div>
        
        <div class="form-group">
          <label for="confirmText">Введите "УДАЛИТЬ АККАУНТ":</label>
          <input type="text" id="confirmText" class="form-control" placeholder='Введите "УДАЛИТЬ АККАУНТ"'>
        </div>
        
        <div class="form-group" style="display: flex; gap: 10px;">
          <button class="btn btn-danger" onclick="deleteAccount()" style="flex: 1;">Удалить аккаунт</button>
          <button class="btn btn-outline" onclick="hideModal('deleteAccountModal')" style="flex: 1;">Отмена</button>
        </div>
      </div>
    </div>
  </div>
</div>
</body>
</html>
